var Microsoft="object"==typeof Microsoft?Microsoft:{};Microsoft.Office=Microsoft.Office||{},Microsoft.Office.Excel=function(e){var t={};function i(s){if(t[s])return t[s].exports;var o=t[s]={i:s,l:!1,exports:{}};return e[s].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=e,i.c=t,i.d=function(e,t,s){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(s,o,function(t){return e[t]}.bind(null,o));return s},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=15)}({15:function(e,t,i){"use strict";var s,o,n;i.r(t),i.d(t,"DocRebootSupportMode",(function(){return yi})),i.d(t,"CommandIds",(function(){return Q})),i.d(t,"EventIds",(function(){return te})),i.d(t,"createCancellationToken",(function(){return ai})),i.d(t,"Application",(function(){return Ei})),i.d(t,"createApplication",(function(){return Ti})),function(e){e[e.h=0]="msoulscat_ES_EWAJS",e[e.u=1]="msoulscat_ES_EWAJSGrid",e[e.g=6]="msoulscat_ES_EWAJSChart",e[e.v=202]="msoulscat_MSOSP_FileMenuCommands",e[e._=220]="msoulscat_MSOSP_AddInCommands",e[e.A=225]="msoulscat_MSOSP_OTelJS",e[e.P=227]="msoulscat_MSOSP_OTelJSInWebWoker",e[e.F=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype",e[e.R=301]="msoulscat_Wac_WordViewer",e[e.U=306]="msoulscat_Wac_BrowserGeneral",e[e.O=320]="msoulscat_Wac_TaskPane",e[e.H=339]="msoulscat_Wac_OneNoteGeneral",e[e.k=340]="msoulscat_Wac_Ribbon",e[e.N=356]="msoulscat_Wac_WacFeedback",e[e.B=379]="msoulscat_Wac_WopiPendingApplication",e[e.$=383]="msoulscat_Wac_Telemetry",e[e.J=391]="msoulscat_Wac_WacCatchUpActivities",e[e.j=394]="msoulscat_Wac_Dictation",e[e.q=395]="msoulscat_Wac_OneNoteSync",e[e.K=700]="msoulscat_Wac_VisioApp",e[e.X=1601]="msoulscat_OneNoteOnline_EditableCache",e[e.Z=800]="msoulscat_Wac_PptAnimation",e[e.Y=833]="msoulscat_Wac_PptLive",e[e.ee=834]="msoulscat_Wac_PptMWeb",e[e.te=835]="msoulscat_Wac_PptGc2General",e[e.ie=836]="msoulscat_Wac_PptGc2GraphicHost",e[e.se=837]="msoulscat_Wac_PptGc2Operation",e[e.oe=852]="msoulscat_Wac_PptGc2EditCanvas",e[e.ne=844]="msoulscat_Wac_PptDataSync",e[e.re=848]="msoulscat_Wac_PptFluidRuntime",e[e.ae=815]="msoulscat_Wac_PptShape",e[e.ce=817]="msoulscat_Wac_PptSession",e[e.le=830]="msoulscat_Wac_PptSlideshow",e[e.he=822]="msoulscat_Wac_PptView",e[e.ue=846]="msoulscat_Wac_PptVideos",e[e.pe=1303]="msoulscat_Uci_Insights",e[e.me=2300]="msoulscat_Wac_VersionHistory",e[e.fe=302]="msoulscat_Wac_WordPresence",e[e.we=3e3]="msoulscat_Wac_OAuth",e[e.ge=3005]="msoulscat_Wac_WordVersionHistory",e[e.ve=3006]="msoulscat_Wac_LivePersonaCard",e[e.Se=3012]="msoulscat_Wac_CatchUpFlyout",e[e._e=3016]="msoulscat_Wac_WordDesigner",e[e.Ie=3021]="msoulscat_Wac_ModernFontPicker",e[e.be=3027]="msoulscat_Wac_UnifiedUiHost",e[e.Ce=3033]="msoulscat_Wac_EquationTools",e[e.ye=1401]="msoulscat_Osf_Latency",e[e.Ee=1402]="msoulscat_Osf_Notification",e[e.Te=1403]="msoulscat_Osf_Runtime",e[e.Ae=3041]="msoulscat_Wac_AiMaker",e[e.Pe=3043]="msoulscat_Wac_AiRewrite",e[e.Fe=3044]="msoulscat_Wac_AiInsert",e[e.Re=3047]="msoulscat_Wac_AiSummarize",e[e.Ue=3048]="msoulscat_Wac_CopilotCompose",e[e.Oe=3049]="msoulscat_Wac_Skittles",e[e.We=3050]="msoulscat_Wac_CopilotChat",e[e.xe=3051]="msoulscat_Wac_Syntex",e[e.Me=3052]="msoulscat_Wac_WireGraph",e[e.He=3053]="msoulscat_Wac_CshCopilot",e[e.ke=3055]="msoulscat_Wac_CopilotProactiveSummary",e[e.Ne=3056]="msoulscat_Wac_CopilotProactiveShared",e[e.De=3057]="msoulscat_Wac_CopilotCursor",e[e.Le=3059]="msoulscat_Wac_WasmGeneral",e[e.Ve=3060]="msoulscat_Wac_WasmTextLayout",e[e.Be=3061]="msoulscat_Wac_WasmSmartArt",e[e.$e=3062]="msoulscat_Wac_WasmClient",e[e.Je=3063]="msoulscat_Wac_WasmNative",e[e.Ge=3068]="msoulscat_Wac_UniversalPrint",e[e.je=4e3]="msoulscat_AIHub_CreateModuleTelemetry",e[e.qe=4001]="msoulscat_AIHub_CreateModuleAugloop",e[e.ze=4002]="msoulscat_AIHub_CreateModuleDAS",e[e.Ke=4003]="msoulscat_AIHub_CreateModuleConfig",e[e.Xe=4004]="msoulscat_AIHub_CreateModuleContext",e[e.Ze=4005]="msoulscat_AIHub_CreateModuleGraph",e[e.Qe=4006]="msoulscat_AIHub_CreateModuleExperiences",e[e.Ye=4007]="msoulscat_AIHub_CreateModuleHttp",e[e.et=4008]="msoulscat_AIHub_CreateModuleRouting",e[e.tt=4009]="msoulscat_AIHub_CreateModuleStorage",e[e.st=4010]="msoulscat_AIHub_CreateModuleStore",e[e.ot=4011]="msoulscat_AIHub_CreateModuleUI",e[e.nt=4012]="msoulscat_AIHub_CreateModuleSharePoint",e[e.rt=4013]="msoulscat_AIHub_CreateModuleLicensing",e[e.ct=4100]="msoulscat_AIHub_CreateModuleUI_Artifacts",e[e.lt=4101]="msoulscat_AIHub_CreateModuleUI_BrandKit",e[e.ht=4102]="msoulscat_AIHub_CreateModuleUI_Forms",e[e.dt=4103]="msoulscat_AIHub_CreateModuleUI_Homepage",e[e.ut=4104]="msoulscat_AIHub_CreateModuleUI_Text",e[e.pt=4105]="msoulscat_AIHub_CreateModuleUI_Video"}(s||(s={})),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Important=20]="Important",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(o||(o={})),function(e){e[e.Firefox=0]="Firefox",e[e.Opera=1]="Opera",e[e.IE=2]="IE",e[e.Edge=3]="Edge",e[e.Chrome=4]="Chrome",e[e.Safari=5]="Safari",e[e.TeamsElectron=6]="TeamsElectron",e[e.AndroidWebView=7]="AndroidWebView",e[e.Unknown=8]="Unknown"}(n||(n={}));const r=window.navigator,a=r?r.userAgent:void 0;function c(){if(a){if(a.indexOf("Firefox")>-1)return n.Firefox;if(a.indexOf("Opera")>-1||a.indexOf("OPR")>-1)return n.Opera;if(a.indexOf("Trident")>-1)return n.IE;if(a.indexOf("Electron")>-1&&a.indexOf("Teams")>-1)return n.TeamsElectron;if(a.indexOf("Android")>-1&&a.indexOf("wv")>-1)return n.AndroidWebView;if(a.indexOf("Edg")>-1)return n.Edge;if(a.indexOf("Chrome")>-1)return n.Chrome;if(a.indexOf("Safari")>-1)return n.Safari}return n.Unknown}function l(){try{return!!a&&a.indexOf("iPad")>=0||!!a&&a.indexOf("Macintosh")>=0&&p()&&!(a&&a.indexOf("iPhone")>=0)||!!a&&a.indexOf("Android")>=0||p()}catch{return!1}}function h(){try{return window.matchMedia("screen and (-ms-high-contrast: active)").matches}catch{return!1}}function d(){return c()===n.IE&&!(c()===n.IE&&null!=document.documentMode&&void 0!==document.documentMode&&document.documentMode>=11)}function u(){try{return window.external&&window.external.getHostEnvironmentValue&&'{"os-sku":"189"}'===window.external.getHostEnvironmentValue("os-sku")}catch(e){return!1}}function p(){return!!r&&r.maxTouchPoints>0}const m=["eurppc"];function f(e){return 8===e.toLowerCase().indexOf("ffc")}function w(e){return 8===e.toLowerCase().indexOf("ppc")}function g(e){const t=e.match(/^https:\/\/((?!word)\w+)(-\w+)+\..*$/i);return t&&t[1]?t[1]:"public"}function v(e,t){if(!t||-1===m.indexOf(t.toLowerCase()))return e;const i=e.match(/(^http[s]:\/\/)((?!word)\w*[-])?(.*)/i);return i?`${i[1]}${t}-${i[3]}`:e}function S(e){const t=e.match(/^(.*?\/\/[^\/]+)(.*)$/);if(!t)throw new Error("Invalid URL");return t[1]}function _(e,t){const i=e.match(/^(.*?\/\/)([^\/:]+)(.*)$/);if(!i)throw new Error("Invalid URL");const s=i[2];if(void 0===t)return s;if(t<0)throw new Error("subDomainParts should be at least 1");return s.split(".").slice(-(t+1)).join(".")}function I(e,t,i){i&&(e[t.toLowerCase()]=i)}function b(e,t){e[t.toLowerCase()]=""}function C(e,t){const i=e.toLowerCase(),s=t.toLowerCase();let o=i.indexOf("&"+s+"=");if(-1===o&&(o=i.indexOf("?"+s+"=")),-1===o)return"";const n=o+(t.length+2),r=e.indexOf("&",n);return e.substring(n,-1===r?void 0:r)}function y(e,t,i,s){if(!i)return e;let o=e;const n=o.indexOf("?");let r="&";n===o.length-1||"&"===o.slice(-1)||"&>"===o.slice(-2)?r="":-1===n&&(r="?");const a=t.toLowerCase()+"=",c=new RegExp("\\W"+a,"i").exec(o);if("?"!==r&&c){if(s){const e=c.index+1,t=o.indexOf("&",e);o=o.substring(0,e)+a+i+(-1===t?"":o.substring(t))}return o}return o.concat(r,a,i)}function E(e){const t={},i=e.indexOf("?");return-1===i||i===e.length-1||e.substring(i+1).replace(new RegExp(/<.*?>/g),"").split("&").forEach(e=>{if(e){const i=e.indexOf("=");-1!==i&&i!==e.length-1&&(t[e.substring(0,i).toLowerCase()]=e.substring(i+1))}}),t}function T(e,t){if(!e)return e;let i=e;const s=i.indexOf("?"),o=t.toLowerCase()+"=",n=i.toLowerCase().indexOf(o,s);if(n>=0){const e=i.indexOf("&",n);return i=i.substring(0,n)+(-1===e?"":i.substring(e+1)),"&"===i.slice(-1)&&(i=i.slice(0,-1)),i}return e}function A(e){if(!e)return"";const t=-1===e.indexOf("#")?e.length:e.indexOf("#");let i=e.lastIndexOf("/",t);if(-1!==i&&i+1===e.indexOf("://")+"://".length)return"";i+=1;let s=e.indexOf("?");if(s=s>=t?-1:s,-1!==s&&i>s)return"";const o=-1===s?t:s;return i>=o?"":e.substring(i,o)}function P(e){const t=new RegExp("(c[1-5])h?(-)");return e.replace(t,"$1h$2")}function F(e,t,i){const s=new RegExp("[?&]"+t+"=("+(i||"1")+")\\b","i"),o=e.match(s);return!(!o||i&&o[1]!==i)}function R(e,t){const i=C(e,t);return i?decodeURI(i):i}function U(e){return e?e.indexOf("://")>-1?e.split("/")[2]:e.split("/")[0]:""}function O(e,t){return{shouldPreload:(t,i,s)=>e(t,i,s),preload:(e,i,n,r)=>{t(e,i,r,n).forEach(e=>{!function(e,t,i,n,r){const a=document.createElement("link");if(a.setAttribute("crossorigin","anonymous"),a.rel=W,a.href=e,t){const i=A(e);t.ULS.ft(561059910,s.B,o.Info,"Preloading resource: "+i);const n=()=>{t.ULS.ft(561059911,s.B,o.Error,"Resource failed to load: "+i)};a.addEventListener("error",n)}a.setAttribute("as","script"),n&&a.setAttribute("integrity",n),document.head.appendChild(a)}(e[0],n,0,e[1])})}}}const W=function(){const e=c();return e===n.Firefox||e===n.IE?"prefetch":"preload"}(),x={en:"1033",cs:"1029",da:"1030",de:"1031",el:"1032",fi:"1035",fr:"1036",hu:"1038",it:"1040",ja:"1041",ko:"1042",nl:"1043",nb:"1044",sk:"1051",sv:"1053",tr:"1055",uk:"1058",sl:"1060",es:"3082",pl:"1045",ro:"1048",ru:"1049"};function M(e=!1,t){return{shouldPreconnect:e=>H&&(!t||t(e)),preconnect:t=>function(e){const t=document.createElement("link");t.rel="preconnect",t.href=e,t.crossOrigin="anonymous",document.head.appendChild(t)}(e?P(t):t)}}const H=!0;var k;function N(e,t,i){if(!t)return;const s=window.navigator;if(s&&s.sendBeacon)try{return void s.sendBeacon(t,e)}catch{}!function(e,t,i){const s=new XMLHttpRequest;s.readyState!==XMLHttpRequest.UNSENT&&s.readyState!==XMLHttpRequest.DONE||(s.open("POST",t,i),s.send(e))}(e,t,i)}!function(e){e.Unknown="UNKNOWN",e.Initialized="INITIALIZED",e.Prebooted="PREBOOTED",e.Booting="BOOTING",e.Booted="BOOTED",e.Failed="FAILED",e.Disposing="DISPOSING",e.Disposed="DISPOSED"}(k||(k={}));const D={BUILD_NUMBER:"###VERSION###",BUILD_NUMBER_MINOR:-1};function L(){try{return D.BUILD_NUMBER}catch(e){return D.BUILD_NUMBER}}var V,B;function $(e,t,i){!function(e,t,i,s=!0){const o={type:t.toString(),payloadJson:JSON.stringify(i)};N(JSON.stringify(o),e,s)}(e,V.JSAPI_STATE,{application:t,build:L(),state:i})}function J(){return window.performance.now()}function G(){return Math.round(window.performance.now()+window.performance.timeOrigin)}!function(e){e.JSAPI_STATE="JSAPI_STATE",e.H_V2="H_V2"}(V||(V={})),function(e){e[e.Trace=0]="Trace",e[e.Assert=1]="Assert"}(B||(B={}));class j{getTimeSpentLogging(){return this.wt}addLoggingTime(e){this.wt+=e}configure(e){const t=J();if(e.uploadCadenceInMs&&(this.gt=e.uploadCadenceInMs),e.uploadTriggerSize&&(this.vt=e.uploadTriggerSize),e.sessionId&&(this.St=e.sessionId),e.remoteUlsEndpoint){if(!e.sessionId&&this._t)throw new Error("Remote ULS endpoint is already set");this._t=this.It(e.remoteUlsEndpoint),this.bt=G(),this.Ct()}this.wt+=J()-t}handleTrace(e){const t=J();e.message.length>3072&&(e.message=e.message.substring(0,3072-"... [Trimmed]".length)+"... [Trimmed]"),this.yt.push(e),(this.yt.length>this.vt||e.level===o.Error)&&this.Ct(),this.wt+=J()-t}getUserSessionId(){return this.St}constructor(e){this.gt=3e4,this.vt=30,this.Et=0,this.yt=[],this.bt=G(),this.Tt=[],this.St="",this.wt=0,this.flushOnClose=()=>{this.At(!1,!1)},this.flush=()=>{this.Ct()},this.flushAndSetNewEndpoint=(e,t)=>{var i;const s=this.It(e);s.localeCompare(null!==(i=this._t)&&void 0!==i?i:"",void 0,{sensitivity:"accent"})&&(this.Tt.push(()=>{this._t=s,t&&t()}),this.At(!0,!0))},this.updateEndpointAndFlush=e=>{this._t=this.It(e),this.At(!0,!0)},this.It=e=>e+"?usid="+this.St+"&officeserverversion="+L(),this.Ct=()=>{window.setTimeout(()=>this.At(!0,!0),0)},this.At=(e,t)=>{const i=J();window.clearTimeout(this.Pt),this._t&&(this.yt.length>0&&(this.Et+=1,N(function(e,t,i,s){const o=[],n=e.map(e=>function(e,t,i){const s={};if(s.G=e.tag,s.T=e.timestamp-t,s.M=e.message,s.C=e.category,e.correlationId){let t=i.findIndex(t=>t===e.correlationId);t<0&&(t=i.push(e.correlationId)-1),s.I=t}const o=1e3*e.type+e.level;return s.D=o,s}(e,s,o)),r=function(e,t,i,s,o){const n={};return n.T=e,n.L=t,n.S=i,n.I=s,o&&o.length>0&&(n.W=o),n.V=1,n}(s,n,t,i,o);return JSON.stringify(r)}(this.yt.splice(0,e?this.vt:this.yt.length),this.St,this.Et,this.bt),this._t,t),this.bt=G()),0===this.yt.length&&this.Tt.length>0&&(this.Tt.forEach(e=>{"requestIdleCallback"in window?window.requestIdleCallback(e):window.setTimeout(e,0)}),this.Tt=[]),e&&(this.Pt=window.setTimeout(()=>{this.Ct()},this.yt.length>this.vt||this.Tt.length>0?1e3:this.gt)),this.wt+=J()-i)},e&&this.configure(e)}}let q,z=[];var K,X,Z,Q,Y,ee,te;function ie(e){const t=new j(e);function i(e,i,s,o){const n=J();if(function(e){return 1===z[e]}(e))return;const r={timestamp:G(),category:i,tag:e,level:s,type:B.Trace,message:o,correlationId:""};t.addLoggingTime(J()-n),t.handleTrace(r)}return{ULS:{ft:(e,t,s,o)=>{i(e,t,s,o)},shipAssertTag:(e,t,s,n)=>{s&&i(e,t,o.Error,n)},debugAssertTag:(e,t,i,s)=>{throw new Error("Debug Asserts not Implemented in the TypeScript bULS module")},flush:t.flush,flushOnClose:t.flushOnClose,setCorrelationId:()=>{}},configure:e=>{t.configure(e)},settingsChangeHandler:e=>{var i,s;i=e.Ft.getValue(K.Rt,""),s=e.Ft.getValue(K.Ut,""),q&&s===q||(z=[],q=s,i&&i.split(",").forEach(e=>{const t=parseInt(e,10);t&&(z[t]=1)})),t.configure({uploadCadenceInMs:e.Ft.getValue(K.Ot,6e4)});const o=e.Ft.getValue(K.Wt,"").toString();""!==o&&t.flushAndSetNewEndpoint(o)},getTimeSpentLogging:()=>t.getTimeSpentLogging(),getUserSessionId:()=>t.getUserSessionId(),flushAndSetNewEndpoint:(e,i)=>{t.flushAndSetNewEndpoint(e,i)},updateEndpointAndFlush:e=>{t.updateEndpointAndFlush(e)}}}function se(e){if(e){const t=e.lastIndexOf(".");if(-1!==t)return e.substring(t+1).toLowerCase()}return""}function oe(e){if(!e)return"";const t=Object.getOwnPropertyNames(e),i=Object.getOwnPropertyNames(Object.getPrototypeOf(e));return JSON.stringify(e,[...t,...i])}function ne(e,t){return{isFeatureEnabled:i=>function(e,t,i){if(t)try{return t(e)}catch(e){i&&i.ULS.ft(594883024,s.B,o.Error,"IsFeatureEnabled callback error: "+oe(e))}}(i,e,t)}}function re(e,t){const i={};if(Object.keys(X).forEach(t=>{const s=e.isFeatureEnabled(X[t]);void 0!==s&&(i[X[t]]=s?"1":"0")}),t&&t.wdFlights){const e=t.wdFlights.toLowerCase();for(const t of e.split(","))"et-treatment"!==t&&"et-control"!==t||(i[X.xt]="et-treatment"===t?"1":"0")}return JSON.stringify(i)}!function(e){e.Mt="BootstrapperMaxUlsHeartbeatTime",e.Ht="BootstrapperNoCompleteWarning1Time",e.kt="BootstrapperNoCompleteWarning2Time",e.Nt="BootstrapperNoCompleteWarning3Time",e.Ut="RemoteUlsETag",e.Rt="RemoteUlsSuppressions",e.Dt="BootstrapperSettingsFetchPeriod",e.Lt="timestamp",e.Vt="BootstrapperUlsHeartbeatIntervalMs",e.Bt="BootstrapperUlsHeartBeatIsEnabled",e.Ot="BootstrapperUlsUploadCadenceMs",e.$t="RequestedCallThrottlingDefaultToViewMinimumValue",e.Wt="BulsEndpointUrl",e.Jt="EnableCommonHostDiagnosticsParams",e.Gt="EnableICNForWord",e.jt="EnableModernEmbedViewForPowerPoint",e.qt="EnableModernEmbedViewInOneUpForPowerPoint",e.zt="EnableModernEmbedViewForPowerPointGlobalAppUrl",e.Kt="EnableModernReadingViewForPowerPoint",e.Xt="EnableModernViewForPowerPointIPad",e.Zt="EnableEarlyFormSubmitMWeb",e.Qt="EnableIpadAndTabletRedirection",e.Yt="EnableMWebLegacyRedirect",e.ei="EnablePassingCustomFontCatalogToViewer",e.ti="EnableDefaultToModernForPowerPoint",e.ii="ShouldLogJsApiKpisForWord",e.si="WordSwitchToViewInTeamsJsapiV1Enabled",e.oi="EnableWordSessionRefreshTelemetry",e.ni="PowerPointUseEssDCHint",e.ri="PowerPointEnableControl24DCsExcludeFromESS",e.ai="PowerPointListOfControl24DCsExcludedFromESS",e.ci="ModernEmbedViewBootstrapperFeatureGatesForPowerPoint",e.li="ModernReadingViewBootstrapperFeatureGatesForPowerPoint",e.hi="ModernEmbedViewForPowerPointEnabledPercentage",e.di="PowerPointESSCookieLookbackThresholdHour",e.pi="PowerPointSetESSCookieLookbackExpEnabled",e.mi="ExcelForceViewOnlyInTeamsJsapiV1",e.wi="EnableWordSessionRefreshLoggingCleanup",e.gi="WordRefreshTelemetryExpirationInDays",e.vi="IsSpoSandboxFixEnabled",e.Si="WordConsumptionViewToEditRedirectIsEnabled",e._i="WordMobileToUnifiedReadRedirectIsEnabled",e.Ii="WordEditorBizchatSideBySideUnifiedReadIsEnabled",e.bi="IPadPreviewerExpEnabled"}(K||(K={})),function(e){e.xt="EnterpriseTemplates",e.Ci="ExcelAdaptiveLayoutDownload",e.yi="ExcelLandingPageOfflineTelemetry",e.Ei="ExcelLandingPageObserverRetry",e.Ti="H2StaticContent",e.Ai="HashedUrl",e.Pi="ODCShareLinkPreload",e.Fi="OfficeComExcelJsApiV2",e.Ri="OfficeComPptJsApiV2",e.Ui="OfficeComUiHost",e.Oi="OfficeComWordJsApiV2",e.Wi="OfficeHwaUiHost",e.xi="OfficeUnifiedUiHostTeams",e.Mi="WordViewToUnifiedRead",e.Hi="DocAspxMsalLoad",e.ki="WordWebInteractiveReadOnlyMode"}(X||(X={}));class ae{add(e){e&&this.Ni.push(e)}remove(e){if(!e)return;const t=this.Ni.indexOf(e);t>-1&&this.Ni.splice(t,1)}removeAll(){this.Ni=[]}dispatch(e,t){this.Ni.forEach(i=>{try{i(e)}catch(e){t&&t(e)}})}constructor(){this.Ni=[]}}class ce{updateEnvironment(e){this.Di=(f(e)?"FF":"Prod")+this.Li+"Settings",this.Vi()}initializePeriodicFetch(e,t){this.Di=(f(e)?"FF":"Prod")+this.Li+"Settings",this.Vi(),this.Bi=e+"AppSettingsHandler.ashx?app="+this.Li+"&usid="+t+"&build="+L(),this.$i||(this.$i=window.setTimeout(this.Ji,3e4))}getValue(e,t){if(this.Gi||this.Vi(),!this.Gi||!this.Gi.hasOwnProperty(e))return t;const i=this.Gi[e],s=typeof t;if(typeof i===s)return i;if("string"==typeof i){if("number"===s)return parseInt(i,10);if("boolean"===s)return"true"===i}return t}addSettingsChangeListener(e){this.ji.add(e)}removeSettingsChangeListener(e){this.ji.remove(e)}dispose(){this.$i&&window.clearTimeout(this.$i),this.qi&&self.cancelIdleCallback(this.qi),this.$i=void 0,this.qi=void 0,this.Gi=void 0,this.ji.removeAll()}constructor(e,t){this.zi=0,this.Vi=()=>{try{if(!window||!window.localStorage)return;const e=window.localStorage.getItem(this.Di);if(!e)return;const t=JSON.parse(e);this.Ki(t)}catch(e){this.Xi.ULS.ft(592836768,s.B,o.Warning,"Failed to get settings from localStorage: "+oe(e))}},this.Ki=e=>!!this.Zi(e)&&(this.Gi=e,this.ji.dispatch({Ft:this},e=>{this.Xi.ULS.ft(592836769,s.B,o.Error,"Settings listener error: "+oe(e))}),!0),this.Zi=e=>{if(e&&"object"==typeof e){if(e.hasOwnProperty(K.Lt)&&!isNaN(e.timestamp))return!0;this.Xi.ULS.ft(592836770,s.B,o.Error,"Received invalid settings")}return!1},this.Ji=()=>{if(!this.Bi)return;const e=new XMLHttpRequest;window.location.href.indexOf("wdnetcorerouting=true")>-1?e.setRequestHeader("X-NetCoreRouting","true"):window.location.href.indexOf("wdnetcorerouting=false")>-1&&e.setRequestHeader("X-NetCoreRouting","false"),e.open("GET",this.Bi),e.responseType="json",e.timeout=5e3,e.send(),e.onload=()=>{if(200===e.status&&e.response?(this.Qi(e.response),this.zi=0):(this.Xi.ULS.ft(592836771,s.B,o.Error,`Fetch settings error. Status: ${e.status}, curErrors: ${this.zi}`),this.zi+=1),this.zi>7)return;let t=this.getValue(K.Dt,3e5);this.zi>3&&(t+=(this.zi-3+1)*(t/2)),this.$i=window.setTimeout(this.Ji,t)}},this.Qi=e=>{"requestIdleCallback"in window?(this.qi&&self.cancelIdleCallback(this.qi),this.qi=window.requestIdleCallback(()=>this.Yi(e),{timeout:1e4})):window.setTimeout(()=>this.Yi(e),0)},this.Yi=e=>{if(!this.Ki(e)||!window||!window.localStorage)return;const t=JSON.stringify(e);try{window.localStorage.setItem(this.Di,t)}catch(e){this.Xi.ULS.ft(592836800,s.B,o.Warning,"Failed to set localStorage: "+oe(e))}},this.Li=e,this.Di="Prod"+e+"Settings",this.Xi=t,this.ji=new ae,this.Vi()}}!function(e){e.appReboot="appReboot",e.boot="boot",e.closeTab="closeTab",e.createNew="createNew",e.dispose="dispose",e.frameTrust="frameTrust",e.getAuthToken="getAuthToken",e.getHostKeyValue="getHostKeyValue",e.handleBootState="handleBootState",e.postWacToken="postWacToken",e.rename="rename",e.setOverlayContent="setOverlayContent",e.storeHostKeyValue="storeHostKeyValue",e.switchMode="switchMode",e.updateBootComplete="updateBootComplete",e.setWacFlightValue="setWacFlightValue"}(Z||(Z={})),function(e){e.blurFocus="blurFocus",e.boot="boot",e.completeCreateNew="completeCreateNew",e.continueAccessibilityLoop="continueAccessibilityLoop",e.createNew="createNew",e.dispose="dispose",e.grabFocus="grabFocus",e.moveToFolder="moveToFolder",e.popState="popState",e.sendChannelId="sendChannelId",e.sendConvId="sendConvId",e.teamsUsersReply="teamsUsersReply",e.teamsUserMentionReply="teamsUserMentionReply",e.backButtonPressed="backButtonPressed",e.getClientUrl="getClientUrl",e.getWebUrl="getWebUrl",e.rename="rename",e.completeSharedFilePicker="completeSharedFilePicker",e.sendAccessToken="sendAccessToken",e.sendAuthToken="sendAuthToken",e.sendCustomAuthConfig="sendCustomAuthConfig",e.sendEmbeddedViewUrl="sendEmbeddedViewUrl",e.sendFrameTrustResult="sendFrameTrustResult",e.sendHWRTelemetry="sendHWRTelemetry",e.sendSessionInfo="sendSessionInfo",e.sendUserAccessAndPermissions="sendUserAccessAndPermissions",e.sendWopiInfo="sendWopiInfo",e.sendDavUrl="sendDavUrl",e.switchMode="switchMode",e.signalShared="signalShared",e.postWacToken="postWacToken"}(Q||(Q={})),function(e){e.ts="App_AccessibilityLoopComplete",e.ss="Wac_ActionComplete",e.os="WacInitialize_Ready",e.ns="Wac_AppFailed",e.as="Wac_AppBootState",e.ls="Wac_AppCompleted",e.hs="BrowserEvent",e.ds="UI_Close",e.us="App_CloseTab",e.ps="UI_Conversation",e.ms="UI_CopyAndEdit",e.fs="App_CreateNewDocument",e.ws="Wac_AppDataSavedStatus",e.gs="UI_Download",e.vs="UI_PreDownloadFileInClient",e.Ss="UI_Edit",e._s="Error",e.Is="UI_FileEmbed",e.bs="UI_FileProperties",e.Cs="File_Rename",e.ys="File_RenameFailed",e.Es="UI_FileVersions",e.Ts="StateChanged",e.As="App_IsFrameTrusted",e.Ps="GetAccessToken",e.Fs="App_GetAuthToken",e.Rs="App_GetCustomAuthConfig",e.Us="App_GetHostKeyValue",e.Os="App_WopiInfoFromUrl",e.Ws="App_DavUrlFromIds",e.xs="App_LoadingStatus",e.Ms="App_SwitchMode",e.Hs="App_MoveToFolder",e.ks="UI_OpenInMobileApp",e.Ns="UI_OpenInBrowser",e.Ds="UI_OpenInClient",e.Ls="PageChanged",e.Vs="App_PushCommentContext",e.Bs="App_PushState",e.$s="App_DocReboot",e.Js="UI_RedeemForCommenting",e.Gs="App_RefreshSessionInfo",e.js="UI_ReplyWithChanges",e.qs="UI_ReportAbuse",e.zs="App_FilePicker",e.Ks="UI_SaveStatus",e.Xs="WopiSession_Complete_Ack",e.Zs="SetOverlayContent",e.Qs="UI_Sharing",e.Ys="UI_ShareForm",e.eo="UI_SignIn",e.io="App_StoreHostKeyValue",e.so="App_Unloaded",e.oo="App_UlsLog",e.no="Wac_UnloadingApp",e.ao="App_UpdateBootComplete",e.co="PageCount",e.lo="UI_CheckUserAccessAndGrantPermissions",e.ho="User_Activity",e.do="Edit_Notification",e.uo="UI_Workflow",e.po="ZoomChanged",e.mo="CAAEMessage",e.fo="Excel_HostFrameCacheSave",e.wo="Excel_HostFrameCacheEvict",e.vo="Excel_RegenerateFileBundle",e.So="App_SwitchToWacFrame",e._o="App_SaveSSRData",e.Io="App_PurgeDataInHostCache",e.bo="App_SaveHostRenderingV2Data",e.Co="App_SaveHostUtilsData",e.yo="AcquireOAuthTokenTeams",e.Eo="App_SwitchNotebook",e.To="FailedBoot_CheckFileInfo",e.Ao="GetTeamsUsers",e.Po="SendTeamsUserMention",e.Fo="NavigateBackToHost",e.Ro="App_GetClientUrlComplete",e.Uo="App_GetWebUrlComplete",e.Oo="App_CopyLinkComplete",e.Wo="App_SendConversationId",e.xo="CloseTeamsConversation",e.Mo="PageLoaded",e.Ho="Visio_BRS",e.No="Visio_SendLicenseInfo",e.Do="Visio_Consumption_CLTComplete",e.Lo="Visio_SwitchMode_FromViewFrame",e.Vo="Visio_ModeSwitch_ToHost_Ack",e.Bo="Visio_UpdateEditUrl",e.$o="Visio_PageViewLoaded",e.Jo="Visio_ActiveAppFrameLoadFailed",e.Go="Visio_DisposeBkgFrame",e.jo="Visio_ReadyToReceiveDocData",e.qo="Visio_DocReboot_HostNav",e.zo="Visio_SwitchToVisioFrame",e.Ko="WacAppPerfMetric",e.Xo="App_ModifyURLState",e.Zo="App_WacTokenAck",e.Qo="App_InitEnd",e.Yo="App_SplashScreenShown",e.tn="App_SetWacFlightValue",e.in="App_PrintRedirect",e.sn="App_RequestFullScreen",e.on="App_ShowCopilotBottomBar",e.nn="UI_ExternalDocumentShare"}(Y||(Y={})),function(e){e.rn="Ack",e.an="WacInitialize_Ready_Ack",e.cn="Wac_BeforeUnloadApp",e.ln="Blur_Focus",e.hn="Wac_AppFailed_Ack",e.dn="Wac_AppCompleted_Ack",e.un="WopiStartSession_Complete",e.pn="WopiPendingSession_Complete",e.mn="Host_AccessibilityLoopComplete",e.As="Host_IsFrameTrusted",e.fn="Grab_Focus",e.wn="HostCacheDiagnostic",e.gn="Host_KeyValue",e.vn="JsApiDiagnostics",e.Hs="Host_MoveToFolder",e.Sn="PageChanged_Ack",e._n="App_PopState",e.In="Host_SendChannelId",e.bn="Host_SendConversationId",e.Cn="GetTeamsUsers_Reply",e.yn="SendTeamsUserMention_Reply",e.En="Host_BackButtonPressed",e.Tn="Host_GetClientUrl",e.An="Host_GetWebUrl",e.Pn="File_Rename",e.zs="Host_FilePicker",e.Fn="PostAccessToken",e.Rn="Host_SetAuthToken",e.Un="Host_SetCustomAuthConfig",e.On="App_PushCommentContext",e.Wn="CanEmbed",e.xn="Host_RefreshSessionInfo",e.Mn="CheckUserAccessAndGrantPermissions_Result",e.Hn="Host_WopiInfoFromUrl",e.kn="Host_DavUrlFromIds",e.Nn="SetCurrentPage",e.Dn="SetZoomLevel",e.Ln="WopiPendingSession_Fail",e.Vn="SetOverlayContent",e.Bn="WopiPendingApplicationComplete_Received",e.$n="Host_SwitchMode",e.Jn="Host_Unload",e.Gn="PageCount_Ack",e.jn="ZoomChanged_Ack",e.qn="Host_ShareUI",e.zn="Host_Telemetry",e.Kn="Visio_ConsumptionCLTComplete_Ack",e.Xn="Visio_SwitchMode_FromHF_Ack",e.Zn="Visio_SwitchMode_FromHostFrame",e.Qn="Visio_FallbackToLegacySwitch",e.Yn="Visio_DocumentData",e.er="Host_PostWacToken"}(ee||(ee={})),function(e){e.AccessibilityLoopCompleted="AccessibilityLoopCompleted",e.ActionCompleted="ActionCompleted",e.BrowserEvent="BrowserEvent",e.CAAEMessage="CAAEMessage",e.Close="Close",e.InitEnd="InitEnd",e.Conversation="Conversation",e.CopyAndEdit="CopyAndEdit",e.CreateNewDocument="CreateNewDocument",e.Download="Download",e.PreDownloadFileInClient="PreDownloadFileInClient",e.Edit="Edit",e.Error="Error",e.FileEmbed="FileEmbed",e.FileProperties="FileProperties",e.FileRenamed="FileRenamed",e.FileVersions="FileVersions",e.FrameStateChanged="FrameStateChanged",e.FrameTrust="FrameTrust",e.GetAccessToken="GetAccessToken",e.GetAuthToken="GetAuthToken",e.GetCustomAuthConfig="GetCustomAuthConfig",e.GetWopiInfoFromUrl="GetWopiInfoFromUrl",e.GetDavUrlFromIds="GetDavUrlFromIds",e.ModeSwitched="ModeSwitched",e.MoveToFolder="MoveToFolder",e.OpenInMobileApp="OpenInMobileApp",e.OpenInBrowser="OpenInBrowser",e.OpenInClient="OpenInClient",e.PageChanged="PageChanged",e.PushState="PushState",e.Reboot="Reboot",e.RedeemForCommenting="RedeemForCommenting",e.RefreshSessionInfo="RefreshSessionInfo",e.ReplyWithChanges="ReplyWithChanges",e.ReportAbuse="ReportAbuse",e.SharedFilePicker="SharedFilePicker",e.SaveStatus="SaveStatus",e.Share="Share",e.ShareForm="ShareForm",e.SignIn="SignIn",e.SplashScreenShown="SplashScreenShown",e.UserAccessAndPermissions="UserAccessAndPermissions",e.UserActivity="UserActivity",e.UserEditActivity="UserEditActivity",e.Workflow="Workflow",e.ZoomChanged="ZoomChanged",e.AcquireOAuthTokenTeams="AcquireOAuthTokenTeams",e.LoadingStatus="LoadingStatus",e.SwitchNotebook="SwitchNotebook",e.FailedBootCheckFileInfo="FailedBootCheckFileInfo",e.GetTeamsUsers="GetTeamsUsers",e.SendTeamsUserMention="SendTeamsUserMention",e.NavigateBackToHost="NavigateBackToHost",e.GetClientUrlComplete="GetClientUrlComplete",e.GetWebUrlComplete="GetWebUrlComplete",e.CopyLinkComplete="CopyLinkComplete",e.SendConversationId="SendConversationId",e.CloseTeamsConversation="CloseTeamsConversation",e.PageLoaded="PageLoaded",e.FrameChanged="FrameChanged",e.PrintRedirect="PrintRedirect",e.RequestFullScreen="RequestFullScreen",e.ShowCopilotBottomBar="ShowCopilotBottomBar",e.ExternalDocumentShare="ExternalDocumentShare"}(te||(te={}));const le={[Q.boot]:{ir:Z.boot},[Q.createNew]:{ir:Z.createNew},[Q.dispose]:{ir:Z.dispose},[Q.postWacToken]:{ir:Z.postWacToken},[Q.rename]:{ir:Z.rename},[Q.switchMode]:{ir:Z.switchMode},[Y.as]:{ir:Z.handleBootState},[Y.us]:{ir:Z.closeTab},[Y.As]:{ir:Z.frameTrust},[Y.Fs]:{ir:Z.getAuthToken},[Y.Us]:{ir:Z.getHostKeyValue},[Y.$s]:{ir:Z.appReboot},[Y.tn]:{ir:Z.setWacFlightValue},[Y.Zs]:{ir:Z.setOverlayContent},[Y.io]:{ir:Z.storeHostKeyValue},[Y.ao]:{ir:Z.updateBootComplete},[Q.blurFocus]:{sr:ee.ln},[Q.continueAccessibilityLoop]:{sr:ee.mn},[Q.grabFocus]:{sr:ee.fn},[Q.moveToFolder]:{sr:ee.Hs},[Q.popState]:{sr:ee._n},[Q.sendChannelId]:{sr:ee.In},[Q.sendConvId]:{sr:ee.bn},[Q.teamsUsersReply]:{sr:ee.Cn},[Q.teamsUserMentionReply]:{sr:ee.yn},[Q.backButtonPressed]:{sr:ee.En},[Q.getClientUrl]:{sr:ee.Tn},[Q.getWebUrl]:{sr:ee.An},[Q.sendAccessToken]:{sr:ee.Fn},[Q.sendAuthToken]:{sr:ee.Rn},[Q.sendHWRTelemetry]:{sr:ee.zn},[Q.sendCustomAuthConfig]:{sr:ee.Un},[Q.sendDavUrl]:{sr:ee.kn},[Q.sendEmbeddedViewUrl]:{sr:ee.Wn},[Q.sendFrameTrustResult]:{sr:ee.As},[Q.sendSessionInfo]:{sr:ee.xn},[Q.sendUserAccessAndPermissions]:{sr:ee.Mn},[Q.sendWopiInfo]:{sr:ee.Hn},[Q.signalShared]:{sr:ee.qn},[Q.completeSharedFilePicker]:{sr:ee.zs},[Y.ts]:{or:te.AccessibilityLoopCompleted},[Y.ss]:{or:te.ActionCompleted},[Y.hs]:{or:te.BrowserEvent},[Y.mo]:{or:te.CAAEMessage},[Y.ds]:{or:te.Close},[Y.ps]:{or:te.Conversation},[Y.ms]:{or:te.CopyAndEdit},[Y.fs]:{or:te.CreateNewDocument},[Y.gs]:{or:te.Download},[Y.vs]:{or:te.PreDownloadFileInClient},[Y.Ss]:{or:te.Edit},[Y._s]:{or:te.Error},[Y.Is]:{or:te.FileEmbed},[Y.bs]:{or:te.FileProperties},[Y.Cs]:{or:te.FileRenamed},[Y.Es]:{or:te.FileVersions},[Y.Ps]:{or:te.GetAccessToken},[Y.Ws]:{or:te.GetDavUrlFromIds},[Y.Rs]:{or:te.GetCustomAuthConfig},[Y.Os]:{or:te.GetWopiInfoFromUrl},[Y.Ts]:{or:te.FrameStateChanged},[Y.Ms]:{or:te.ModeSwitched},[Y.Hs]:{or:te.MoveToFolder},[Y.ks]:{or:te.OpenInMobileApp},[Y.Ns]:{or:te.OpenInBrowser},[Y.Ds]:{or:te.OpenInClient},[Y.Ls]:{or:te.PageChanged},[Y.Bs]:{or:te.PushState},[Y.Js]:{or:te.RedeemForCommenting},[Y.Gs]:{or:te.RefreshSessionInfo},[Y.js]:{or:te.ReplyWithChanges},[Y.zs]:{or:te.SharedFilePicker},[Y.qs]:{or:te.ReportAbuse},[Y.Ks]:{or:te.SaveStatus},[Y.Qs]:{or:te.Share},[Y.Ys]:{or:te.ShareForm},[Y.eo]:{or:te.SignIn},[Y.lo]:{or:te.UserAccessAndPermissions},[Y.ho]:{or:te.UserActivity},[Y.do]:{or:te.UserEditActivity},[Y.uo]:{or:te.Workflow},[Y.po]:{or:te.ZoomChanged},[Y.yo]:{or:te.AcquireOAuthTokenTeams},[Y.xs]:{or:te.LoadingStatus},[Y.Eo]:{or:te.SwitchNotebook},[Y.To]:{or:te.FailedBootCheckFileInfo},[Y.Ao]:{or:te.GetTeamsUsers},[Y.Po]:{or:te.SendTeamsUserMention},[Y.Fo]:{or:te.NavigateBackToHost},[Y.Ro]:{or:te.GetClientUrlComplete},[Y.Uo]:{or:te.GetWebUrlComplete},[Y.Oo]:{or:te.CopyLinkComplete},[Y.Wo]:{or:te.SendConversationId},[Y.xo]:{or:te.CloseTeamsConversation},[Y.Mo]:{or:te.PageLoaded},[Y.Qo]:{or:te.InitEnd},[Y.Yo]:{or:te.SplashScreenShown},[Y.in]:{or:te.PrintRedirect},[Y.sn]:{or:te.RequestFullScreen},[Y.on]:{or:te.ShowCopilotBottomBar},[Y.nn]:{or:te.ExternalDocumentShare}};function he(){const e=new Uint8Array(31),t=function(e){const t={crypto:!1,perfNow:!1,exceptions:[]},i=window.crypto||window.msCrypto;if(i){t.crypto=!0;try{return i.getRandomValues(e),t}catch(e){t.exceptions.push("crypto: "+oe(e))}}t.perfNow=!0;for(let i=0;i<e.length;i+=1){try{let e=Math.floor(100*window.performance.now())%10;(e<0||e>9)&&(e=0);for(let t=0;t<e;t+=1)Math.random()}catch(e){t.exceptions.push("Math.random: "+oe(e))}e[i]=Math.floor(16*Math.random())}return t}(e);let i=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const s=15&e[i];return i+=1,("x"===t?s:3&s|8).toString(16)}),t]}function de(e,t){try{if(void 0===window.performance)return void t.ULS.ft(595948609,s.B,o.Info,"Performance not supported");const i=window.performance.getEntriesByType("resource");if(void 0===i||i.length<=0)return void t.ULS.ft(595948610,s.B,o.Info,"No resources under performance");const n=new RegExp(e+"(-boot\\.min|(\\.(app|preview))?\\.boot)(\\.[0-9a-f]{20})?\\.js","i");for(let e=i.length-1;e>=0;e-=1){const r=i[e],a=r.name.match(n);if(a){let e=JSON.stringify(r);return e=e.replace(new RegExp(r.name,"g"),a[0]),void t.ULS.ft(595948616,s.B,o.Info,e)}}t.ULS.ft(595948484,s.B,o.Info,"Could not find JSAPI resource timing entry")}catch(e){t.ULS.ft(595948617,s.B,o.Info,"Could not trace the resource timing: "+oe(e))}}function ue(e){var t,i;const s={...e.host,sessionId:e.hostSessionId,domain:location?location.host:void 0};delete s.siteId,delete s.webId,delete s.uiHostTabId;const o={};if(e.wdParams){const t=JSON.parse(JSON.stringify(e.wdParams).toLowerCase());["wdorigin","wdpreviouscorrelation","wdprevioussession","wdtf"].forEach(e=>{t[e]&&(o[e]=t[e])});const i=/^\w{8}(-|%2d)\w{4}(-|%2d)\w{4}(-|%2d)\w{4}(-|%2d)\w{12}$/i;o.wdprevioussession&&!i.test(o.wdprevioussession)&&delete o.wdprevioussession,o.wdpreviouscorrelation&&!i.test(o.wdpreviouscorrelation)&&delete o.wdpreviouscorrelation}const n={...e.rebootOverride};delete n.ackExpected,delete n["ui-language"],delete n.wdUserSession,delete n.rebootMode,delete n.documentUrl;const r=e.wopi;return{accessToken:r?{length:r.accessToken.length,expiry:r.expiry}:"N/A",wacToken:r&&r.wacToken?{length:r.wacToken.length}:void 0,bootParams:e.bootParams,build:L(),host:s,intent:e.intent,jsApiVersion:"v2",rebootOverride:n,region:g(e.appBaseUrl),sessionOrigin:e.hostInitDiagnostics?e.hostInitDiagnostics.entryPoint:void 0,sessionContext:e.sessionContext,throttling:e.throttling,ui:e.ui,viewMode:e.viewMode,meeting:e.meeting?{id:null===(t=e.meeting)||void 0===t?void 0:t.id,isPresenter:null===(i=e.meeting)||void 0===i?void 0:i.isPresenter}:void 0,wdParams:o}}function pe(){const e={perfNowSupported:!0,browser:n[c()],touchMode:l(),highContrast:h(),windows10x:u()};try{const t=window.navigator,i=t.connection||t.mozConnection||t.webkitConnection;i&&(e.netOnline=t.onLine,e.netDownlink=i.downlink,e.netDownlinkMax=i.downlinkMax,e.netEffectiveType=i.effectiveType,e.netRtt=i.rtt,e.netSaveData=i.saveData,e.netType=i.type),e.deviceMemory=t.deviceMemory,e.logicalProcessors=t.hardwareConcurrency}catch{}return e}var me;function fe(e){const t=window.performance.timing;t&&(e.hostPageNavigationStartTime||(e.hostPageNavigationStartTime=t.navigationStart),e.hostPageFetchStartTime||(e.hostPageFetchStartTime=t.fetchStart),e.hostPageRequestStartTime||(e.hostPageRequestStartTime=t.requestStart),e.hostPageResponseStartTime||(e.hostPageResponseStartTime=t.responseStart),e.hostPageResponseEndTime||(e.hostPageResponseEndTime=t.responseEnd),e.hostPageDomCompleteTime||(e.hostPageDomCompleteTime=t.domComplete));const i=window.performance.navigation;if(i&&(void 0===e.hostPageRedirectCount&&(e.hostPageRedirectCount=i.redirectCount),!e.hostPageNavigationType)){let t="UNKNOWN";switch(i.type){case 0:t="NAVIGATE";break;case 1:t="RELOAD";break;case 2:t="BACK_FORWARD";break;case 255:t="RESERVED"}e.hostPageNavigationType=t}}!function(e){e[e.Unknown=0]="Unknown",e[e.Normal=1]="Normal",e[e.Minor=2]="Minor",e[e.Medium=3]="Medium",e[e.Major=4]="Major",e[e.Critical=5]="Critical"}(me||(me={}));class we{dispose(){window.removeEventListener("beforeunload",this.nr,{capture:!0}),window.removeEventListener("pagehide",this.rr,{capture:!0}),window.removeEventListener("visibilitychange",this.ar,{capture:!0}),window.removeEventListener("unload",this.cr,{capture:!0})}constructor(e,t){this.nr=()=>ge(e,"OnBeforeUnload",t),this.rr=()=>ge(e,"OnPageHide",t),this.ar=()=>ge(e,"VisibilityChange_"+document.visibilityState,t),this.cr=()=>ge(e,"OnUnload",t),window.addEventListener("beforeunload",this.nr,{capture:!0,once:!0}),window.addEventListener("pagehide",this.rr,{capture:!0}),window.addEventListener("visibilitychange",this.ar,{capture:!0}),window.addEventListener("unload",this.cr,{capture:!0,once:!0})}}function ge(e,t,i){e.ULS.ft(595957843,s.B,o.Important,`Page lifecycle: ${t} fired`+(i?", flushing logger":"")),i&&e.ULS.flush()}const ve=["https://augloop.office.com/v2","api://visio.officeapps.live.com/va/00695ed2-3202-4156-8da1-69f60065e255","394866fc-eedb-4f01-8536-3ff84b16be2a","https://officescripting.microsoft.com","https://officescripting-int.microsoft.com","https://nleditor.osi.office.net/nleditor","e03a13ee-9730-4cae-8525-47559c8cf18a","https://powerquery.microsoft.com","api://app.powerbi.com/00000009-0000-0000-c000-000000000000","https://immersivereader.cloud.microsoft","https://forms.office.com"];class Se{async isResourceTrustedForMessage(e){if(!e||!e.Resource)return!1;const t=e.Resource,i=e.AddinTrustId,n=function(e){if(!e)return!1;const t=e.toLowerCase();for(const e of ve)if(e===t||e+"/"===t)return!0;return!1}(t);if(n||!i)return n;if(this.lr[i])return _e(t,this.lr[i]);let r;const a=new Promise(e=>{r=(s,o)=>{i===s&&e(_e(t,o))},this.hr.push(r)});let c=-1;const l=new Promise(e=>{c=window.setTimeout(()=>{this.Xi.ULS.ft(560754786,s.B,o.Warning,"isResourceTrustedForMessage - timeout waiting for addinTrustId: "+i),e(!1)},2e3)}),h=await Promise.race([a,l]);return this.hr=this.hr.filter(e=>e!==r),window.clearTimeout(c),h}dispose(){this.lr={},this.hr=[],window.removeEventListener("message",this.dr)}constructor(e){this.lr={},this.hr=[],this.dr=e=>{if(e&&e.origin)try{const t=e.data;if("string"==typeof t&&t.includes("AddinTrustedOrigin")){const i=JSON.parse(t),n=i.AddinTrustId;n&&"AddinTrustedOrigin"===i.MessageId&&(this.Xi.ULS.ft(560754784,s.B,o.Info,"didReceiveMessage addinTrustId "+n),this.lr[n]=e.origin,this.hr.forEach(t=>{t(n,e.origin)}))}}catch(e){this.Xi.ULS.ft(560754785,s.B,o.Error,"AuthTokenTrustValidator didReceiveMessage failed")}},this.Xi=e,window.addEventListener("message",this.dr)}}function _e(e,t){try{if(!e||!t)return!1;const i=33,s=126,o=/[?&#%\\]/;for(let t=0;t<e.length;t+=1){const n=e.charCodeAt(t);if(n<i||n>s)return!1;const r=e.charAt(t);if(o.test(r))return!1}const n="api:",r="https:";let a=e;a.substring(0,n.length).toLowerCase()===n&&(a=`${r}${a.substring(n.length)}`);const c=new URL(a);return c.protocol===r&&t.toLowerCase()===c.origin.toLowerCase()}catch{return!1}}class Ie{get diagnostics(){return{hostInitDiagnostics:this.hostInitDiagnostics,appInitDiagnostics:this.appInitDiagnostics}}raiseEvent(e,t){this.logger.ULS.ft(574654541,s.B,o.Info,"Raising event: "+e);try{this.ur(e,t)}catch(e){this.logger.ULS.ft(593506838,s.B,o.Error,"Event handler error: "+oe(e))}}addActionHandler(e,t){this.pr[e]||(this.pr[e]=[]),this.pr[e].push(t)}removeActionHandler(e,t){const i=this.pr[e];if(i&&i.length>0){const e=i.indexOf(t);e>-1&&i.splice(e,1)}}run(e,t,i){if(this.state===k.Disposed&&this.backgroundSession)return this.logger.ULS.ft(525203609,s.B,o.Info,"Redirecting to background session: "+e),this.backgroundSession.run(e,t,i);const n=[],r=this.pr[e];if(r&&r.length>0)n.push(this.mr(e,t));else{const r=le[e];if(r){const a=r.ir,c=r.sr;if(a){this.logger.ULS.ft(574654542,s.B,o.Info,"Running flow: "+a);const r=this.wr[a](e,t,this,this.gr[a],i).catch(e=>(this.vr(a,e),{completion:"failure",errorSource:"jsapi",error:e}));n.push(r)}else c&&(this.container&&this.container.postMessage(c,t),n.push(Promise.resolve({completion:"success"})))}else n.push(Promise.resolve({completion:"failure"})),this.logger.ULS.ft(593500189,s.B,o.Warning,"Unhandled command: "+e)}return Promise.race(n)}dispose(){if(this.successTime=0,this.failureTime=0,this.timeoutTime=0,this.Ft.dispose(),this.pageStateObserver.dispose(),this.authTokenTrustValidator.dispose(),this.pr={},!this.pendingReboot){const e=this.application.sessions,t=e.indexOf(this.session);t>-1&&e.splice(t,1)}}constructor(e,t,i,n,r,a,c){var l;this.successTime=0,this.failureTime=0,this.timeoutTime=0,this.appBootState="Unknown",this.pendingReboot=!1,this.skipWopiValidation=!1,this.skipFileNameCheck=!1,this.appContext={},this.isLoggerFromOwl=!1,this.appUrl="",this.appBaseUrl="",this.appBasePath="",this.remoteTelemetryUrl="",this.pr={},this.onMessage=e=>{const t=e.MessageId,i=e.Values||{},n=this.pr[t];if(n&&n.length>0)this.mr(t,i);else{const n=le[t];if(n){const r=n.ir,a=n.or;r?(this.logger.ULS.ft(574654543,s.B,o.Info,"Running flow: "+r),this.wr[r](t,i,this,this.gr[r]).catch(e=>{this.vr(r,e)})):a&&(a===te.Share&&(i.sendTimeAsClickTime=e.SendTime),this.raiseEvent(a,i))}}},this.vr=(e,t)=>{this.logger.ULS.ft(596459925,s.B,o.Error,`${e} flow error: ${oe(t)}`),this.remoteTelemetryUrl&&$(this.remoteTelemetryUrl,this.appInfo.name,"flowException")},this.mr=(e,t)=>{this.logger.ULS.ft(574654544,s.B,o.Info,"Dispatching action: "+e);const i=this.pr[e].slice().reverse();for(let n=i.length-1;n>-1;n-=1)try{i[n](e,t)}catch(t){this.logger.ULS.ft(596444186,s.B,o.Error,`${e} action handler error: ${oe(t)}`)}return Promise.resolve({completion:"success"})},this.state=k.Unknown;const[h,d]=he();this.isLoggerFromOwl=!!i.logger,this.logger=null!==(l=i.logger)&&void 0!==l?l:ie(),this.logger.ULS.ft(593506837,s.B,o.Info,JSON.stringify(d)),this.sessionId=h,this.hostSessionId=i.hostSessionId,this.host=e.host,this.hostName=this.host.uiHostName||this.host.storageHostName,this.user=e.user,this.bootstrapperUrl=e.bootstrapperUrl,this.ui=e.ui||{},this.viewMode=e.viewMode,this.application=n,this.appInfo=t,this.session=r,this.featureManager=ne(e.host.capabilities&&e.host.capabilities.isFeatureEnabledCallback,this.logger),this.Ft=new ce(t.name,this.logger),this.preloader=t.preloader,[this.wr,this.gr]=a(this.featureManager),this.ur=c,this.clientDiagnostics=pe(),this.pageStateObserver=new we(this.logger,!0),this.authTokenTrustValidator=new Se(this.logger)}}class be{get id(){return this.Sr.sessionId}get diagnostics(){return this.Sr.diagnostics}run(e,t,i){return this.Sr.run(e,t,i)}boot(e,t){return this.Sr.run(Q.boot,e,t)}dispose(e){return this.Sr.run(Q.dispose,void 0,e)}constructor(e,t,i,s,o,n){!function(e){if(!e)throw new TypeError("SessionInitParams");if(!e.hostSessionId)throw new TypeError("HostSessionId")}(i),this.Sr=new Ie(e,t,i,s,this,n,(e,t)=>o({type:e,data:t,session:this})),this.Sr.state=k.Initialized}}function Ce(e){if(!e)return"";const t=""+document.cookie,i=new RegExp("(?:^|; )"+e+"=([^;]*)"),s=t.match(i);return!s||s.length<2?"":s[1]}function ye(e,t,i,s=Ee.none,o){const n=e+"="+t;let r="";const a=new Date;a.setTime(a.getTime()+31536e6);let c=new Date;c.setTime(c.getTime()+864e5*i),c>a&&(c=a),c&&(r=";expires="+c.toUTCString());const l=n+r+";SameSite="+Ee[s];return document.cookie=o?l+"; Secure":l,!(!document.cookie||-1===document.cookie.indexOf(n))||s===Ee.none&&ye(e,t,i,Ee.doNotSet,o)}var Ee,Te;!function(e){e[e.doNotSet=0]="doNotSet",e[e.none=1]="none",e[e.lax=2]="lax",e[e.strict=3]="strict"}(Ee||(Ee={}));class Ae{setTargetOrigin(e){const t=S(e).toLowerCase();this._r&&this._r!==t&&this.Xi.ULS.ft(593232847,s.B,o.Warning,`Updating origin: [${U(this._r)}]->[${U(t)}]`),this._r=t,this.Ir=_(t,2),this.br=f(t),this.Cr=w(t)}setTargetFrame(e,t){this.yr=e,this.Er=!!t}setMessageHandler(e){this.Tr=e}removeMessageHandler(){this.Tr=void 0}postMessage(e,t,i){if(!this.yr||!this.yr.contentWindow)return void this.Xi.ULS.ft(593232848,s.B,o.Error,"Missing target to send message: "+e);this.Xi.ULS.ft(593232849,s.B,o.Info,"Sending message: "+e);const n={MessageId:e,SendTime:G(),CorrelationId:i,Values:t};this.yr.contentWindow.postMessage(JSON.stringify(n),this._r)}dispose(){window.removeEventListener("message",this.Ar,!1),this.Tr=void 0}constructor(e,t,i,n){var r;this._r="",this.Ir="",this.br=!1,this.Cr=!1,this.Er=!1,this.Pr=!1,this.Ar=e=>{let t,i=!1,n=!0,r="",a=!1;if(this.yr&&this.yr.contentWindow&&(i=!0,n=e.source===this.yr.contentWindow),e.origin&&(r=_(e.origin,2).toLowerCase(),a=r===this.Ir,!a&&this.Fr&&(r=_(e.origin).toLowerCase(),a=this.Fr.includes(r))),!this.br&&(!this.Cr||a&&n)||this.Xi.ULS.ft(593232850,s.B,o.Info,"Window: available["+i+"] valid["+n+"]; Origin: valid["+a+"] expected["+this.Ir+"] actual["+r+"]"),!a||this.Er&&!n)return;try{if("string"!=typeof e.data)return void this.Xi.ULS.ft(505771930,s.B,o.Info,"Event data is not of type string");t=JSON.parse(e.data)}catch(e){return void this.Xi.ULS.ft(593232851,s.B,o.Info,"Failed to parse event data: "+oe(e))}const c=t.MessageId;if(c){var l;if(this.Xi.ULS.ft(593232854,s.B,o.Info,`Received message: ${c}, correlation: ${t.CorrelationId}`),c!==Y.ls&&c!==Y.xs||this.setTargetOrigin(e.origin),t.Values&&t.Values.ackExpected&&this.postMessage(ee.rn,void 0,t.CorrelationId),this.Pr&&c===Y.Ko)return window._pageTimings=null!==(l=window._pageTimings)&&void 0!==l?l:{},void(window._pageTimings[t.Values.name]=t.Values.time);if(this.Tr)try{this.Tr(t)}catch(e){this.Xi.ULS.ft(594556386,s.B,o.Error,"Message handler error: "+oe(e))}else this.Xi.ULS.ft(591933923,s.B,o.Error,"No message handler")}else(this.br||this.Cr)&&this.Xi.ULS.ft(593232853,s.B,o.Info,"Missing message id")},this.Xi=t,this.setTargetOrigin(e),this.Fr=n,i&&this.setMessageHandler(i),this.Pr=!(null===(r=window.location)||void 0===r||null===(r=r.search)||void 0===r||!r.match(/wdpa=1/gi))||"1"===Ce("EnableMetricLogging"),window.addEventListener("message",this.Ar,!1)}}function Pe(e,t){c()===n.Safari?e.style.display=t?"none":"block":e.style.visibility=t?"hidden":"visible"}function Fe(e,t,i){I(t,Te.Rr,String(i?window.outerHeight:e.offsetHeight)),I(t,Te.Ur,String(i?window.outerWidth:e.offsetWidth)),I(t,Te.Or,String(l())),I(t,Te.Wr,String(h())),I(t,Te.xr,String(u())),I(t,Te.Mr,String(function(){try{return window.matchMedia("(prefers-color-scheme: dark)").matches}catch{return!1}}())),I(t,Te.Hr,String(function(){try{return window.matchMedia("(prefers-contrast: more)").matches}catch{return!1}}())),I(t,Te.kr,String(function(){try{return window.matchMedia("(forced-colors: active)").matches||window.matchMedia("screen and (-ms-high-contrast: active)").matches}catch{return!1}}())),I(t,Te.Nr,String(window.innerHeight)),I(t,Te.Dr,String(window.innerWidth))}function Re(e){try{return window===window.top||window.parent===window.top&&window.location.origin===window.top.origin}catch(t){return e&&e.ULS.ft(591525084,s.B,o.Info,"Trust check error: "+oe(t)),!1}}!function(e){e.Lr="access_token",e.Vr="access_token_ttl",e.Br="wac_token",e.$r="bundleSrc",e.Jr="bundleStaleness",e.Gr="DocID",e.jr="SiteID",e.qr="WebID",e.zr="ETag",e.Kr="feature_status",e.Xr="fileExtension",e.Zr="fileGetUrl",e.Qr="customFontCatalogUrl",e.Yr="fileName",e.ea="fileSize",e.xr="forceSLR",e.Rr="frameHeightPx",e.Ur="frameWidthtPx",e.Wr="highContrast",e.ta="highDpi",e.ia="host_diagnostics",e.sa="hostName",e.oa="huictrls",e.na="owner_id",e.ra="sc",e.aa="softBlockedBrowser",e.ca="templateUrl",e.Or="touchMode",e.la="user_id",e.ha="hfck",e.ua="hfcv",e.pa="timeZoneId",e.Mr="darkCssMedia",e.kr="forcedColors",e.Hr="prefersContrast",e.ma="caae",e.fa="meetingId",e.wa="meetingTitle",e.ga="meetingType",e.va="scheduledStartTime",e.Sa="scheduledEndTime",e._a="isPresenter",e.Ia="meetingOrganizerId",e.ba="meetingJoinUrl",e.Ca="isMeetingTeamsRoom",e.ya="jsapibuild",e.Ea="owlver",e.Ta="owlro",e.Aa="caaemode",e.Pa="traceparent",e.Fa="tracestate",e.Ra="supports_zipit",e.Ua="sipcn",e.Oa="devcs",e.Wa="dceit",e.Nr="frameInnerHeightPx",e.Dr="frameInnerWidthPx"}(Te||(Te={}));class Ue{get element(){return this.xa}get frameId(){return this.Ma}get formId(){return this.Ha}get isTopFrameTrusted(){return this.ka}boot(e,t,i,n,r,a,c){this.Xi=i,this.Na=new Ae(e,i,this.Tr,n.additionalReceivingDomainList);const l=n.useAdditionalDiv,h=n.permissionsPolicy;this.Da&&!l?(this.Da.setAttribute("allow",h),this.Xi.ULS.ft(588793045,s.B,o.Info,"Wac frame reused")):(this.Da=function(e,t,i,s,o,n,r,a,c,l){e.style.top="0",e.style.bottom="0",e.style.left="0",e.style.right="0",e.style.height="100%",e.style.width="100%";const h=e.ownerDocument,d=h.createElement("iframe");if(d.id=t,d.name=t,d.src="",d.title="Office on the web Frame",d.marginWidth="0",d.marginHeight="0",d.style.top="0",d.style.bottom="0",d.style.left="0",d.style.right="0",d.style.height="100%",d.style.width="100%",d.style.display="block",d.style.position="absolute",d.style.backgroundColor="transparent",d.style.border="none",d.frameBorder="0",d.setAttribute("allowfullscreen","true"),d.setAttribute("allowTransparency","true"),d.setAttribute("allow",i),Pe(d,r),s&&(e.style.minHeight=s,d.style.minHeight=s),o&&(e.style.minWidth=o,d.style.minWidth=o),a&&d.setAttribute("role","none"),n){const t=h.createElement("div");t.style.top="0",t.style.bottom="0",t.style.left="0",t.style.right="0",t.style.height="100%",t.style.width="100%",t.style.backgroundColor="#393a3d",t.style.backfaceVisibility="hidden",s&&(t.style.minHeight=s),o&&(t.style.minWidth=o),t.appendChild(d),e.appendChild(t)}else e.appendChild(d);return c&&d.addEventListener("load",c,{once:!0}),l&&d.addEventListener("error",l,{once:!0}),d}(this.xa,this.Ma,h,n.minHeight,n.minWidth,l,n.isInvisible,n.setNoneRole,a,c),this.Xi.ULS.ft(588793046,s.B,o.Info,"Wac frame created")),r(),this.Na.setTargetFrame(this.Da,n.enforceSameWindow),l&&(this.La=this.Da.parentElement),n.useFrameFixForTeams&&i.ULS.ft(509143245,s.B,o.Info,"Frame fix enabled for teams uiHost"),Fe(this.Da,t,n.useFrameFixForTeams),t.parentOrigin=window.origin||"",this.Va=function(e,t,i,s,o){const n=e.ownerDocument,r=n.createElement("form");r.id=i,r.name=i,r.action=s,r.target=t,r.method="POST";for(const e in o){const t=n.createElement("input");t.type="hidden",t.name=e,t.value=o[e],r.appendChild(t)}return e.appendChild(r),r}(this.xa,this.Ma,this.Ha,e,t),this.Va.submit()}setVisibility(e){this.Da&&Pe(this.Da,e)}setMessageHandler(e){this.Tr=e,this.Na&&this.Na.setMessageHandler(e)}setWrapperPostMessage(e){this.Ba=e}removeMessageHandler(){this.Tr=void 0,this.Na&&this.Na.removeMessageHandler()}postMessage(e,t){this.Ba?this.Ba(e,t):this.Na&&this.Na.postMessage(e,t)}dispose(e,t){return new Promise(i=>{if(this.Va&&(this.xa.removeChild(this.Va),this.Va=void 0),this.Na&&(this.Na.dispose(),this.Na=void 0,this.Tr=void 0),this.Ba&&(this.Ba=void 0),this.Xi=void 0,!this.Da||!this.La&&e)i();else{const e=()=>{this.La?(this.La.removeChild(this.Da),this.xa.removeChild(this.La)):this.xa.removeChild(this.Da),this.Da=void 0,this.La=void 0,i()};t?e():(this.Da.src="about:blank",window.setTimeout(e,0))}})}constructor(e,t){!function(e){if(!e||!e.appendChild)throw TypeError("Container")}(e),this.xa=e,this.Ma=t,this.Ha=t+"_Form",this.ka=Re()}}class Oe{get name(){return this.$a.name}get version(){return L()}addEventListener(e){this.Ja.add(e)}removeEventListener(e){this.Ja.remove(e)}createContainer(e){const t=`WacFrame_${this.$a.name}_${this.containers.length}`,i=new Ue(e,t);return this.containers.push(i),i}createSession(e){const t=new be(this.Ga,this.$a,e,this,this.qa,this.za);return this.sessions.push(t),t}dispose(e){const t=this.sessions.map(t=>t.dispose(e).catch(e=>{}));return Promise.all(t).then(e=>(this.Ja.removeAll(),this.sessions=[],this.containers=[],{completion:"success"}))}constructor(e,t,i){this.sessions=[],this.containers=[],this.qa=e=>{this.Ja.dispatch(e)},function(e){if(!e)throw new TypeError("ApplicationInitParams");const t=e.host;if(!t||!t.storageHostName)throw new TypeError("HostInfo");const i=e.user;if(!i||null==i.id)throw new TypeError("UserInfo")}(e),this.Ga=e,this.$a=t,this.za=i,this.Ja=new ae,function(e){if(e&&(D.BUILD_NUMBER=e,e.includes("."))){const t=e.split(".");D.BUILD_NUMBER_MINOR=parseInt((t[0]||"").concat((t[1]||"").padStart(3,"0")),10)}}(e.host.owlVersion)}}let We=!1,xe=!1;function Me(){We=!1}function He(e,t,i,n,r,a,c){if(t.ULS.ft(595714433,s.B,o.Important,`Starting disposing the application. unloadApp:${e}; disposed:${We}; unloading:${xe}`),We||xe&&e)return void t.ULS.ft(595714908,s.B,o.Info,"Application is already disposed or unloading");const l={logger:t,postMessenger:i,innerApplicationFrame:n,onDisposed:r,onFrameRemoved:a,unloadTimeoutInMs:c||1e3,forceAppUnload:!1,disposeStartTime:G(),appUnloadTimedOut:!1};if(e&&n)return xe=!0,l.forceAppUnload=!0,(h=l).forceAppUnloadStartTime=G(),h.logger.ULS.ft(595855490,s.B,o.Info,"Sending postmessage to unload app"),h.logger.ULS.flush(),h.postMessenger.registerMessagePayloadHandler(Y.so,e=>function(e,t){e.forceAppUnloadEndTime=G(),e.appUnloadedMessageValues=t,e.logger.ULS.ft(595855491,s.B,o.Info,"AppUnloaded received from app"),ke(e)}(h,e)),h.postMessenger.sendPostMessage(h.innerApplicationFrame,ee.Jn,{}),void window.setTimeout(()=>function(e){!xe&&We||(e.appUnloadTimedOut=!0,e.logger.ULS.ft(595855492,s.B,o.Info,"ApplicationUnload timed out, forcing dispose"),ke(e))}(h),h.unloadTimeoutInMs);var h;ke(l)}function ke(e){if(!We)try{We=!0,xe=!1,function(e){e.innerApplicationFrame&&(e.innerApplicationFrame.src="about:blank",window.setTimeout(()=>{e.innerApplicationFrame&&e.innerApplicationFrame.parentElement&&e.innerApplicationFrame.parentElement.removeChild(e.innerApplicationFrame),e.onFrameRemoved&&e.onFrameRemoved()},0))}(e),function(e){const t={disposeStartTime:e.disposeStartTime,disposeEndTime:G(),forceAppUnload:e.forceAppUnload,appUnloadTimedOut:e.appUnloadTimedOut};if(e.forceAppUnloadStartTime&&(t.appUnloadStartTime=e.forceAppUnloadStartTime),e.forceAppUnloadEndTime&&(t.appUnloadEndTime=e.forceAppUnloadEndTime),e.appUnloadedMessageValues){const i=e.appUnloadedMessageValues,s=Number(i.hostMessageReceived);e.forceAppUnloadStartTime&&!isNaN(s)&&(t.hostToAppPostMessageLatency=s-e.forceAppUnloadStartTime);const o=Number(i.appMessageSent);!isNaN(o)&&e.forceAppUnloadEndTime&&(t.appToHostPostMessageLatency=e.forceAppUnloadEndTime-o);const n=Number(i.appUnloadStart),r=Number(i.appUnloadEnd);if(isNaN(n)||isNaN(r)||(t.appUnloadLatency=r-n),i.serverTimings){const e=i.serverTimings;for(const i in e)t["st-"+i.toString()]=e[i]}}e.logger.ULS.ft(595855436,s.B,o.Info,"App disposed "+JSON.stringify(t)),e.logger.ULS.flushOnClose()}(e),e.onDisposed&&e.onDisposed()}catch(t){e.logger.ULS.ft(595714434,s.B,o.Error,"Error disposing: "+oe(t))}}var Ne;!function(e){e.AppInitError="AppInitError",e.ApiDisabledError="ApiDisabledError",e.CannotLoadFirstPage="CannotLoadFirstPage",e.InvalidWopiInfo="InvalidWopiInfo",e.TimeoutWacReady="TimeoutWacReady",e.WacFailed="WacFailed"}(Ne||(Ne={}));class De{}De.logger=ie();class Le extends class{constructor(e){this.Ka={},this.resetCache=()=>{if(!this.Xa)return!1;try{return localStorage.removeItem(this.dataSettingsCacheKey),!0}catch(e){return De.logger.ULS.ft(557114832,s.B,o.Error,`${this.dataSettingsCacheKey}: Failure trying to Delete data in localStorage: ${oe(e)}`),!1}},this.setCache=e=>{if(e&&this.Xa)try{localStorage.setItem(this.dataSettingsCacheKey,JSON.stringify(e))}catch(e){De.logger.ULS.ft(557114833,s.B,o.Error,`${this.dataSettingsCacheKey}: Error while saving settings in cache: ${oe(e)}`)}},this.getIntegerSetting=e=>{const t=this.Za(e);if(null!=t&&"number"==typeof t){const e=t;if(!isNaN(e))return e}return null},this.getBooleanSetting=e=>{const t=this.Za(e);return null!=t&&"boolean"==typeof t?t:null},this.getStringSetting=e=>{const t=this.Za(e);return null!=t&&"string"==typeof t?t:null},this.Za=e=>{if(!this.Xa)return null;try{if(e in this.Ka)return this.Ka[e];const t=localStorage.getItem(this.dataSettingsCacheKey);if(null!==t){const i=JSON.parse(t)[e];return this.Ka[e]=i,i}}catch(t){De.logger.ULS.ft(557114834,s.B,o.Error,`${this.dataSettingsCacheKey}: Failure trying to find ${e} setting in localStorage: ${oe(t)}`)}return null},this.dataSettingsCacheKey=e,this.Xa=!1;try{localStorage&&(this.Xa=!0)}catch(e){De.logger.ULS.ft(538018719,s.B,o.Warning,"Local storage not supported: "+oe(e))}}}{static get Instance(){return Le.Qa||(Le.Qa=new Le)}constructor(){super(Le.Ya)}}function Ve(e,t){return e+"_layouts/RemoteTelemetry.ashx"+(t?"?usid="+t:"")}function Be(e,t){return Ve(Je(e),t)}function $e(e,t,i,s,o,n=!1){e.SessionInformation.IsCore&&(e.SessionInformation.HideViewerToolbar=!0),function(e,t){const i=e.SessionInformation;if(i.WdParams||(i.WdParams={}),i.WdParams.wd)return;t.substring(1).split("&").filter(e=>{if(0===e.indexOf("wd")){const t=e.split("=");t[0].length>2&&(i.WdParams[t[0]]=t[1])}});const s=e.RebootOverrideData;s&&s.previousSessionId&&(i.WdParams.wdprevioussession=s.previousSessionId),Le.Instance.getBooleanSetting("OneNoteHostSessionOriginFixEnabled")}(e,window.location.search);const r=o||new ce("Excel",i),a=Je(e.ApplicationUrl);return{container:e.Container,sessionInformation:e.SessionInformation,applicationUrl:e.ApplicationUrl,wopiPrecheckInfo:e.WopiPrecheckInfo,applicationCustomSettings:e.ApplicationCustomSettings,diagnostics:{HostInitDiagnostics:e.Diagnostics,ClientDiagnostics:pe(),AppInitDiagnostics:{officeSessionId:t,officeBootstrapperVersion:L(),hostName:e.SessionInformation.HostName},SessionTraces:{}},fnOnInitializeSuccess:e.FnOnInitializeSuccess,fnOnInitializeFailure:e.FnOnInitializeFailure,sessionId:t,applicationBasePath:a,remoteTelemetryUrl:Ve(a,t),wopiInfo:e.WopiInfo,forceSingleStepBoot:n,isCreateNew:e.WopiPrecheckInfo.IsNewFile||F(e.ApplicationUrl,"new"),featureManager:s||ne(e.FnIsFeatureEnabled,i),Ft:r,newFileTemplateSource:e.NewFileTemplateSource,rebootOverrideData:e.RebootOverrideData,pageStateObserver:new we(i,!0)}}function Je(e){const t=e.match(/^(.*?\/\/[^\/]+\/[^\/]+\/)(.*)$/);if(!t)throw new Error("Invalid URL");return t[1]}function Ge(e,t){t&&t.Diagnostics&&Object.keys(t.Diagnostics).forEach(i=>e[i]=t.Diagnostics[i])}function je(e,t,i){t.ULS.ft(596459999,s.B,i,"SessionTraces: "+JSON.stringify(e))}function qe(e,t){t.stop();const i=t.getVisibilityChangeEvents();null!=i&&i.length>0&&(e.AppInitDiagnostics.documentLoadedWithTabSwitch=!0,e.SessionTraces.tabSwitchDiagnostics=JSON.stringify(i)),t.dispose()}function ze(e,t,i){try{const n=function(e,t){const i={...t};delete i.UserId,delete i.OwnerId,delete i.SiteId,delete i.WebId,delete i.Upn,delete i.TenantId,delete i.UiHostTabId,delete i.OriginalWdParam,delete i.WdParams;const s=i,o=t.WdParams?JSON.parse(JSON.stringify(t.WdParams).toLowerCase()):{};s.WdParams={},["wdorigin","wdpreviouscorrelation","wdprevioussession","wdtf"].forEach(e=>{o[e]&&(s.WdParams[e]=o[e])});const n=/^\w{8}(-|%2d)\w{4}(-|%2d)\w{4}(-|%2d)\w{4}(-|%2d)\w{12}$/i;return s.WdParams.wdprevioussession&&!n.test(s.WdParams.wdprevioussession)&&delete s.WdParams.wdprevioussession,s.WdParams.wdpreviouscorrelation&&!n.test(s.WdParams.wdpreviouscorrelation)&&delete s.WdParams.wdpreviouscorrelation,s.UiEmbedMode=F(e,"uiembed"),s.UiHostName=C(e,"uih")||"N/A",s.HostDomain=location?location.hostname:"",s}(t.applicationUrl,t.sessionInformation);n.Build=L(),n.Region=g(t.applicationUrl);const r={...t.rebootOverrideData};delete r.ackExpected,delete r["ui-language"],delete r.wdUserSession,delete r.rebootMode,delete r.documentUrl,n.RebootOverride=r;const a=t.diagnostics.HostInitDiagnostics;a&&(e.ULS.ft(596444238,s.B,o.Info,"HostInitDiagnostics: "+JSON.stringify(t.diagnostics.HostInitDiagnostics)),n.SessionOrigin=a.entryPoint),i&&e.ULS.ft(595937313,s.B,o.Info,JSON.stringify(i)),e.ULS.ft(595632928,s.B,o.Info,function(){if(window&&window.navigator){const e=window.navigator,t=e.connection||e.mozConnection||e.webkitConnection;if(t)return"EffectiveType: "+t.effectiveType+", BandwidthMps: "+t.downlink+", ConnectionType: "+t.type}return""}());const c=t.wopiInfo;c&&c.AccessToken&&c.AccessTokenExpiry||e.ULS.ft(595894553,s.B,o.Warning,"There are some missing parameters"),c&&(c.AccessToken&&(n.AccessTokenLength=c.AccessToken.length),n.AccessTokenExpiry=c.AccessTokenExpiry,c.WacToken&&(n.WacTokenLength=c.WacToken.length)),"Microsoft Teams"===t.sessionInformation.HostName&&e.ULS.ft(507122579,s.B,o.Important,"Excel setting Force View only for Teams WXP Files session."),n.JsApiVersion="v1",e.ULS.ft(596444237,s.B,o.Important,JSON.stringify({session:n,client:t.diagnostics.ClientDiagnostics}))}catch(t){e.ULS.ft(558155802,s.B,o.Error,"Failed to log initialization info: "+oe(t))}}Le.Ya="OneNote_hostUtilsSettingsCache";const Ke=["c1h-","c2h-","c3h-","c4h-","c5h-","c1-","c2-","c3-","c4-","c5-"];function Xe(e){return new RegExp("xlviewerinternal.aspx","i").test(e)}function Ze(e){return new RegExp("xlembed.aspx","i").test(e)}function Qe(e){return new RegExp("xlpreview.aspx","i").test(e)}let Ye,et,tt,it,st,ot,nt,rt,at,ct,lt;function ht(e,t,i,n){ot=e,nt=t,rt=void 0,at=i,ct=n,Ye=!1,et=!1,tt=0,mt(),setTimeout(()=>{ot.ULS.ft(593589517,s.B,o.Info,"ExcelLandingPageObserver:initExcelLandingPageObserver heartbeat signal called after ms: 3000")},3e3),setTimeout(()=>{!function e(){tt>=3?ot.ULS.ft(595350870,s.B,o.Info,"ExcelLandingPageObserver: checkFirstFlushArrived  Max Limit reached for retry attempts3"):(mt(),Ye?setTimeout(()=>{(!et||tt>0)&&ot.ULS.ft(595350872,s.B,o.Info,"ExcelLandingPageObserver: checkSecondFlushArrived Second Flush status: "+et+" after first flush retry attempt: "+tt)},st):(tt+=1,ot.ULS.ft(595350871,s.B,o.Info,"ExcelLandingPageObserver: checkFirstFlushArrived  Retry Request: "+tt),at&&at.isFeatureEnabled(X.Ei)&&1===tt&&document.getElementById(nt).submit(),setTimeout(()=>{e()},it)))}()},it),at&&at.isFeatureEnabled(X.yi)&&(window.localStorage?window.addEventListener("offline",ft):ot.ULS.ft(593589518,s.B,o.Info,"ExcelLandingPageObserver:initExcelLandingPageObserver localstorage not supported by Browser. Skip saving in cache")),ot.ULS.ft(594622165,s.B,o.Info,"ExcelLandingPageObserver:initExcelLandingPageObserver called with OfflineTelemetry: "+(at?at.isFeatureEnabled(X.yi):"False [featureManager undefined]"))}function dt(e){"PageLoadSkeleton Presented"===e?Ye=!0:"BootstapContext Recieved"===e&&(et=!0)}function ut(){if(at&&at.isFeatureEnabled(X.yi))if(window.localStorage)for(let e=0;e<localStorage.length;e+=1)try{const t=localStorage.key(e);if("OfflineMode_"===t.substring(0,"OfflineMode_".length)){const e=localStorage.getItem(t);ot.ULS.ft(593589520,s.B,o.Info,"ExcelLandingPageObserver:uploadOfflineModeTelemetry Message"+e),localStorage.removeItem(t)}}catch(e){ot.ULS.ft(593589521,s.B,o.Error,"ExcelLandingPageObserver:uploadOfflineModeTelemetry exception during loading from cache. Exception: "+oe(e))}else ot.ULS.ft(593589519,s.B,o.Info,"ExcelLandingPageObserver:uploadOfflineModeTelemetry localstorage not supported by Browser. Skip uploading")}function pt(e){return Xe(e)||Ze(e)}function mt(){it=3750,st=6e3;const e=function(){if(!window||!window.navigator)return;const e=window.navigator.connection||window.navigator.mozConnection||window.navigator.webkitConnection;return e?e.effectiveType:void 0}();if(void 0!==e)switch(void 0!==rt&&rt!==e&&ot.ULS.ft(595350873,s.B,o.Info,"ExcelLandingPageObserver: initializeTimeOutIntervals previousConnection: "+rt+" currentConnection: "+e+" First Flush: "+Ye+" Second Flush:"+et),rt=e,e){case"4g":it=3750,st=6e3;break;case"3g":it=5e3,st=8e3;break;case"2g":it=1e4,st=24e3;break;case"slow-2g":it=2e4,st=4e4}}function ft(){try{const e=G(),t="OfflineMode_"+ct+"_"+e,i={"Sessionid:":ct,OfflineTime:e};localStorage.setItem(t,JSON.stringify(i))}catch(e){ot.ULS.ft(593589522,s.B,o.Error,"ExcelLandingPageObserver:logOfflineModeTelemetry exception during saving into cache exception: "+oe(e))}}function wt(e,t,i){lt=e;try{if(window.localStorage)if(i){const e=(e,t)=>{vt(t)};i.addActionHandler(Y.fo,e);const t=(e,t)=>{St(t)};i.addActionHandler(Y.wo,t)}else t&&(t.registerMessagePayloadHandler(Y.fo,e=>{vt(e)}),t.registerMessagePayloadHandler(Y.wo,e=>{St(e)}));else lt.ULS.ft(574677217,s.B,o.Warning,"ExcelHostFrameCacheManager: initHostFrameCacheManager: localstorage not supported by Browser. Skip saving HostFrame cache save")}catch(e){lt.ULS.ft(574677218,s.B,o.Warning,"ExcelHostFrameCacheManager: initHostFrameCacheManager: error while initializing.")}}function gt(e,t,i){try{lt||(lt=e);let n=`${t[Te.Gr]}_${i}_${t[Te.sa]}_${t[Te.la]}`;if(n="XlHc_"+function(e){let t=0;const i=e.length;let s=0;if(i>0)for(;s<i;)t=(t<<5)-t+e.charCodeAt(s)|0,s+=1;return t}(n),t[Te.ha]=n,window.localStorage){const e=localStorage.getItem(n);null!==e&&(t[Te.ua]=e)}else lt.ULS.ft(574677219,s.B,o.Warning,"ExcelHostFrameCacheManager: setHostFrameCachePostData: localstorage not supported by Browser. Skip saving HostFrame cache save")}catch(e){lt.ULS.ft(574677248,s.B,o.Warning,"ExcelHostFrameCacheManager: setHostFrameCachePostData: error while setting host frame cache post data.")}}function vt(e){if(e&&e.hasOwnProperty("cacheItemKey")&&0===e.cacheItemKey.indexOf("XlHc_")&&e.hasOwnProperty("cacheItemValue"))try{window.localStorage.setItem(e.cacheItemKey,e.cacheItemValue),lt.ULS.ft(574677249,s.B,o.Info,"ExcelHostFrameCacheManager: handleHostFrameSaveMessage: setting localstorage HostFrame cache item")}catch(e){lt.ULS.ft(574677250,s.B,o.Warning,"ExcelHostFrameCacheManager: handleHostFrameSaveMessage: error while saving HostFrame to local storage. error: "+oe(e))}else lt.ULS.ft(574677251,s.B,o.Warning,"ExcelHostFrameCacheManager: handleHostFrameSaveMessage: HostFrame cache save message does not contain all expected values, skipping HostFrame cache save")}function St(e){if(e&&e.hasOwnProperty("workbookList")&&e.hasOwnProperty("evictAllExceptListed"))try{const t=e.evictAllExceptListed,i=JSON.parse(e.workbookList);lt.ULS.ft(574677252,s.B,o.Info,"ExcelHostFrameCacheManager: handleHostFrameEvictMessage: removing items from cache. workbookList length: "+i.length+", evictAllExceptListed: "+t),!0===t?function(e){const t=new Date,i=new Date(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),t.getUTCMilliseconds()).getTime();for(let t=0;t<localStorage.length;t+=1){const n=localStorage.key(t);let r=!1;if(0===n.indexOf("XlHc_")){if(e.indexOf(n)<0)r=!0;else{const e=localStorage.getItem(n);let t;try{t=JSON.parse(e)}catch(e){lt.ULS.ft(574677255,s.B,o.Warning,"ExcelHostFrameCacheManager: evictAllItemsExcept: unable to check for stale HostFrame cache, error parsing HostFrame cache item, error: "+oe(e))}t?i-t.LastModified>5184e6&&(r=!0):r=!0}r&&(localStorage.removeItem(n),lt.ULS.ft(574677256,s.B,o.Verbose,"ExcelHostFrameCacheManager: EvictAllItemsExcept: Removed HostFrame cache item"))}}}(i):function(e){for(let t=0;t<e.length;t+=1)localStorage.removeItem(e[t]),lt.ULS.ft(574677257,s.B,o.Verbose,"ExcelHostFrameCacheManager: EvictSpecificItems: Removed HostFrame cache item")}(i)}catch(e){lt.ULS.ft(574677253,s.B,o.Warning,"ExcelHostFrameCacheManager: handleHostFrameEvictMessage: error while evicting HostFrame from local storage. error: "+oe(e))}else lt.ULS.ft(574677254,s.B,o.Warning,"ExcelHostFrameCacheManager: handleHostFrameEvictMessage: HostFrame cache evict message does not contain all expected values")}var _t;function It(e,t,i=!1){let s=e.applicationUrl;e.wopiPrecheckInfo.IsNewFile&&s.replace("unified=1","edit=1&new=1");let o={};if("Microsoft Teams"===e.sessionInformation.HostName&&(o.fvo="1",s=T(s,"unified")),o.jsApi="1",o.jsapiver="v1",i&&(o.NewSession="1"),o.corrid=e.sessionId,o.usid=e.sessionId,o.sftc="1",(e.applicationCustomSettings&&e.applicationCustomSettings.IsCore||e.sessionInformation.IsCore)&&(o.core="1"),e.sessionInformation.HideViewerToolbar&&(o.hvt="1"),e.sessionInformation.HideEditUpsellDialog&&(o.hdeditdlg="1"),e.sessionInformation.DisableFocusOnBoot&&(o.disableFocusOnBoot="1"),e.sessionInformation.HighContrastMode&&(o.hcm=encodeURIComponent(e.sessionInformation.HighContrastMode)),e.sessionInformation.SupportsAtMentions&&(o.sams="1"),e.sessionInformation.SupportsAccessibilityLoop&&(o.accloop="1"),e.sessionInformation.SupportsDocReboot){const t=e.sessionInformation.SupportsDocReboot;o.sdr=!0===t?"1":t.toString()}e.sessionInformation.SupportsCreateNewDocument&&(o.scnd="1"),e.sessionInformation.SupportsAuthToken&&(o.sat="1"),window.docAspxMsalEnabled&&"onedrivecom"!==E(e.applicationUrl).uih&&(e.sessionInformation.AuthTokenStrategy="PairwiseBroker"),e.sessionInformation.AuthTokenStrategy&&(o.ats=e.sessionInformation.AuthTokenStrategy),e.sessionInformation.SupportsCustomAuthConfig&&(o.cac="1"),e.sessionInformation.TopOrigin&&(o.to=encodeURIComponent(e.sessionInformation.TopOrigin)),e.sessionInformation.IsDeeplyNestedAuthSupportedInTeams&&(o.dnaa="1"),e.sessionInformation.SupportsMoveToFolder&&(o.mtf="1"),e.sessionInformation.SupportsCommonFilePicker&&(o.sfp="1"),e.sessionInformation.OpenLinksInNewWindow&&(o.onw="1"),e.sessionInformation.UseDarkTheme&&(o.udt="1"),e.sessionInformation.SupportsExcelExternalLinks&&(o.xlel="1"),e.sessionInformation.SupportsRefreshAccessToken&&(o.rat="1"),(e.sessionInformation.HideHeader||"DocGen"===e.sessionInformation.ContentAssemblyMode||"Templatization"===e.sessionInformation.ContentAssemblyMode||"ContentAssemblyEdit"===e.sessionInformation.ContentAssemblyMode||"ContentAssemblyView"===e.sessionInformation.ContentAssemblyMode)&&(o.hhdr="1"),e.sessionInformation.HideAppLauncherInHeader&&(o.halh="1"),e.sessionInformation.HideChatInHeader&&(o.hch="1"),e.sessionInformation.HideMeInHeader&&(o.hmh="1"),e.sessionInformation.HideSearchInHeader&&(o.hsh="1"),e.sessionInformation.HideWorkflowInHeader&&(o.hwfh="1"),e.sessionInformation.HideSettingsInHeader&&(o.hsth="1"),e.sessionInformation.ShowAppIconInHeader&&(o.sih="1"),e.sessionInformation.UseNeutralColorInHeader&&(o.unh="1"),e.sessionInformation.HideBreadCrumbInViewer&&(o.hbcv="1"),e.sessionInformation.HideTitleInViewer&&(o.htv="1"),e.sessionInformation.HideWACOneDriveFileLocationPicker&&(o.hodflp="1"),e.sessionInformation.NoBrowserModalDialogs&&(o.nbmd="1"),e.applicationCustomSettings&&e.applicationCustomSettings.FixDiagnosticsJson&&(o.fixdiag="1"),e.wopiPrecheckInfo.ReadOnly&&(o.readOnly="1",e.wopiPrecheckInfo.ReadOnly&&(o.mode="Read")),"DocGen"!==e.sessionInformation.ContentAssemblyMode&&"ContentAssemblyView"!==e.sessionInformation.ContentAssemblyMode||(o.readOnly="1"),e.sessionInformation.UIEmbed&&(o.uiEmbed="1"),e.sessionInformation.IsSynthetic&&(o.syn="1"),e.sessionInformation.SupportsDirectDownload&&(o.sdd="1"),e.sessionInformation.SupportsDirectPrint&&(o.sdp="1"),e.sessionInformation.DisableOfficeAddins&&(o.doa="1"),e.sessionInformation.UiHostIntegrationType&&(o.uihit=encodeURIComponent(e.sessionInformation.UiHostIntegrationType)),e.sessionInformation.MetaUiHostVersion&&(o.muv=encodeURIComponent(e.sessionInformation.MetaUiHostVersion)),e.applicationCustomSettings&&e.applicationCustomSettings.InAppDocumentPreview&&(o.InAppDocPreview="1"),t.isSingleStepBoot?(t.bootFlowType===_t.unifiedSingleFlush&&(e.isCreateNew||(o.instantedit="1",o.wopicomplete="1")),o.wdRedirectionReason=t.bootFlowType):(o.instantedit="1",o.fileSrc=encodeURIComponent(e.sessionInformation.HostName),o.pmOrigin=encodeURIComponent(S(window.location.href)),e.isCreateNew&&(o.new="1",e.wopiPrecheckInfo.IsNewFileFromHostTemplate&&(o.wdTpl="fromhost"))),e.wopiPrecheckInfo.PreseededSessionKey&&(o.preseededSessionKey=encodeURIComponent(e.wopiPrecheckInfo.PreseededSessionKey)),e.wopiPrecheckInfo.PreseededWacSessionId&&(o.preseededWacSessionId=encodeURIComponent(e.wopiPrecheckInfo.PreseededWacSessionId)),e.wopiPrecheckInfo.RequestedCallThrottling&&(o.rct=e.wopiPrecheckInfo.RequestedCallThrottling),e.wopiPrecheckInfo.ClientThrottlingProtection&&(o.ctp=e.wopiPrecheckInfo.ClientThrottlingProtection);{const t=e.wopiPrecheckInfo.FileSize,i=52428800,s=104857600;t&&t>=i&&t<=s&&(o.ilf="1")}return e.applicationCustomSettings&&e.applicationCustomSettings.additionalApplicationParameters&&(o={...e.applicationCustomSettings.additionalApplicationParameters,...o}),e.rebootOverrideData&&e.rebootOverrideData.queryOverrides&&(o={...o,...e.rebootOverrideData.queryOverrides}),e.sessionInformation.AfdFlighting&&(o.afdflight=Math.floor(100*Math.random()+1).toString()),function(e,t,i,s,o){let n=E(e);("teams"===n.uih&&"UnifiedUiHostTeams"!==t.UiHostIntegrationType&&"TeamsModern"!==t.UiHostIntegrationType||"owa"===n.uih)&&(n.hhdr="1");const r=e.indexOf("?"),a=-1===r?e.concat("?"):e.substring(0,r+1);t.UiLocale&&(n.ui=encodeURIComponent(t.UiLocale)),t.DataLocale&&(n.rs=encodeURIComponent(t.DataLocale)),t.HostSessionId&&(n.hid=encodeURIComponent(t.HostSessionId)),t.DisableChat&&(n.dchat="1"),t.SessionContext&&(n.sc=encodeURIComponent(t.SessionContext)),i&&i.WopiSrc&&(n.wopisrc=encodeURIComponent(i.WopiSrc)),t.CookieCompliant&&(n.mscc="1"),s&&(s.entryPoint&&(n.wdorigin=encodeURI(s.entryPoint)),s.userClickTime&&(n.wdhostclicktime=s.userClickTime.toString())),n={...n,...t.WdParams,...o};const c={};for(const e in n)c[e.toLowerCase()]=n[e];const l=[];for(const e in c)c[e]&&l.push(e.concat("=",c[e]));return a.concat(l.join("&"))}(s,e.sessionInformation,e.wopiInfo,e.diagnostics.HostInitDiagnostics,o)}function bt(e){return e.AccessTokenExpiry?e.AccessTokenExpiry.getTime().toString():"0"}!function(e){e.bootWithoutWopiInfo="",e.unifiedSingleFlush="Unified_SingleFlush",e.unifiedIrmEnabled="Unified_IrmEnabled",e.unifiedViewActionUrl="Unified_ViewActionUrl",e.unifiedNotEditOrViewActionUrl="Unified_NotEditOrViewActionUrl",e.forceSingleStepBoot="Force_SingleStepBoot",e.wordUiEmbedReadOnlyEarlyRedirect="WordUiEmbed_ReadOnlyEarlyRedirect",e.wordUiEmbedIrmEnabledEarlyRedirect="WordUiEmbed_IrmEnabledEarlyRedirect",e.wordViewToUnifiedReadRedirect="WordView_UnifiedReadRedirect",e.wordMobileUnifiedReadRedirect="WordMobile_UnifiedReadRedirect"}(_t||(_t={}));const Ct={[Q.blurFocus]:ee.ln,[Q.continueAccessibilityLoop]:ee.mn,[Q.grabFocus]:ee.fn,[Q.moveToFolder]:ee.Hs,[Q.popState]:ee._n,[Q.rename]:ee.Pn,[Q.sendAccessToken]:ee.Fn,[Q.sendAuthToken]:ee.Rn,[Q.sendCustomAuthConfig]:ee.Un,[Q.sendEmbeddedViewUrl]:ee.Wn,[Q.sendSessionInfo]:ee.xn,[Q.sendUserAccessAndPermissions]:ee.Mn,[Q.sendWopiInfo]:ee.Hn,[Q.sendDavUrl]:ee.kn,[Q.completeSharedFilePicker]:ee.zs,[Q.switchMode]:ee.$n,[Q.signalShared]:ee.qn};class yt{registerMessagePayloadHandler(e,t){if(this.ec[e])throw new Error("Duplicate registration!");this.ec[e]=t}removeMessageHandler(e){delete this.ec[e]}sendPostMessage(e,t,i){if(!e||!e.contentWindow)return void this.Xi.ULS.ft(595948308,s.B,o.Info,"Missing target for SendPostMessage");this.Xi.ULS.ft(596464334,s.B,o.Info,"Sending message: "+t);const n={MessageId:t,SendTime:G(),Values:i};this.tc(e.contentWindow,JSON.stringify(n),this._r)}activate(e,t){this.ic=e,this.Er=!!t,this.oc||(window.addEventListener("message",this.nc,!1),this.oc=!0)}postMessageForCommand(e,t,i){const n=Ct[t];n?(this.Xi.ULS.ft(595702598,s.B,o.Info,`Sending message ${n} for command ${t}`),this.sendPostMessage(e,n,i)):this.Xi.ULS.ft(595702599,s.B,o.Warning,"No mapping for command "+t)}dispose(){this.ec={},this.oc&&(window.removeEventListener("message",this.nc,!1),this.oc=!1)}constructor(e,t){var i;if(this.oc=!1,this.ec={},this._r="",this.Ir="",this.Er=!1,this.br=!1,this.Cr=!1,this.Pr=!1,this.rc=[],this.ac=!0,this.cc=(e,t,i)=>{if(!e)return void this.Xi.ULS.ft(595736136,s.B,o.Info,"Missing target to send Ack back");const n={MessageId:ee.rn,CorrelationId:i,SendTime:G()};this.Xi.ULS.ft(595732176,s.B,o.Info,"Sending Ack back"),e.postMessage(JSON.stringify(n),t)},this.nc=e=>{let t,i=!1,n=!0,r="",a=!1;if(this.ic&&this.ic.contentWindow&&(i=!0,n=e.source===this.ic.contentWindow),e.origin&&(r=_(e.origin,2).toLowerCase(),a=r===this.Ir,!a&&this.Fr&&(r=_(e.origin).toLowerCase(),a=this.Fr.includes(r))),!this.br&&(!this.Cr||a&&n)||this.Xi.ULS.ft(595730526,s.B,o.Info,`Window is available: ${i}, window is valid: ${n}, origin is valid: ${a}, expected origin: ${this.Ir}, actual origin: ${r}`),!a||this.Er&&!n)return;try{t=JSON.parse(e.data)}catch(e){return void this.Xi.ULS.ft(596464282,s.B,o.Info,`Failed to parse event data: ${oe(e)}.`)}const c=t.MessageId;if(!c)return void((this.br||this.Cr)&&this.Xi.ULS.ft(595730520,s.B,o.Info,"Could not find message id"));var l;if(this.Xi.ULS.ft(595714715,s.B,o.Info,`Received messageId: ${c}, correlation: ${t.CorrelationId}`),c!==Y.ls&&c!==Y.xs||this.lc(e.origin),this.Pr&&c===Y.Ko)return window._pageTimings=null!==(l=window._pageTimings)&&void 0!==l?l:{},void(window._pageTimings[t.Values.name]=t.Values.time);t.Values&&t.Values.ackExpected&&this.cc(e.source,e.origin,t.CorrelationId);const h=this.ec[c];if(!h)return this.Xi.ULS.ft(596464289,s.B,o.Info,"No handler found for message id: "+c),void(this.ac&&c===Y.Fs&&(this.rc.push(t),this.Xi.ULS.ft(543207888,s.B,o.Info,"Kept for later process: "+c)));this.Xi.ULS.ft(596464288,s.B,o.Info,"Processing message: "+c),c===Y.Qs&&(t.Values={...t.Values||{},sendTimeAsClickTime:t.SendTime});try{h(t.Values||{})}catch(e){this.Xi.ULS.ft(593773704,s.B,o.Error,"Handler error: "+oe(e))}this.ac&&c===Y.ls&&this.hc()},this.hc=()=>{this.ac=!1,this.rc.forEach(e=>{const t=e.MessageId,i=this.ec[t];if(i){this.Xi.ULS.ft(543207890,s.B,o.Info,"Processing message after boot complete: "+t);try{i(e.Values||{})}catch(e){this.Xi.ULS.ft(543207891,s.B,o.Error,"Handler error: "+oe(e))}}else this.Xi.ULS.ft(543207889,s.B,o.Info,"No handler found after boot complete: "+t)}),this.rc=[]},this.tc=(e,t,i)=>{e.postMessage(t,i)},this.lc=e=>{const t=e.toLowerCase();this._r&&this._r!==t&&this.Xi.ULS.ft(596128131,s.B,o.Warning,`Updating origin: [${U(this._r)}]->[${U(t)}]`),this._r=t,this.Ir=_(t,2),this.br=f(t),this.Cr=w(t)},!e)throw new Error("Missing origin for PostMessageHandler");this.br=f(e),this.Cr=w(e),this.Xi=t,this.lc(e),this.Pr=!(null===(i=window.location)||void 0===i||null===(i=i.search)||void 0===i||!i.match(/wdpa=1/gi))||"1"===Ce("EnableMetricLogging")}}class Et{setFrameError(){this.dc=!0}setTimeoutStage(e){this.uc=e,this.pc="Boot_HeartBeat_"+e+(this.dc?"_FrameError":"")}restart(){const e=this.mc.getValue(K.Bt,!1);this.fc=J()+(this.wc?this.wc:this.mc.getValue(K.Mt,6e5));const t=this.br?3e3:5e3;this.gc=window.setInterval(()=>{e&&this.Xi.ULS.ft(595724178,s.B,o.Info,this.pc),J()>this.fc&&(this.stop(),this.vc(),this.Sc&&this.Sc())},this.mc.getValue(K.Vt,t)),this._c.push(window.setTimeout(this.vc,this.mc.getValue(K.Ht,3e4),1)),this._c.push(window.setTimeout(this.vc,this.mc.getValue(K.kt,12e4),2)),this._c.push(window.setTimeout(this.vc,this.mc.getValue(K.Nt,18e4),3))}stop(){this.fc=0,this.gc&&(window.clearInterval(this.gc),this.gc=void 0),this._c.forEach(e=>{window.clearTimeout(e)}),this._c=[]}constructor(e,t,i,n,r){this.fc=0,this._c=[],this.br=!1,this.pc="Boot_HeartBeat",this.dc=!1,this.uc="FrameCreated",this.vc=e=>{const t="Boot_NotComplete_"+(e||"Final")+"_"+this.uc+(this.dc?"_FrameError":"");this.Xi.ULS.ft(594901218,s.B,o.Warning,t),this.Xi.ULS.flush()},this.br=e,this.mc=t,this.Xi=i,this.Sc=n,this.wc=r,this.restart()}}function Tt(e){localStorage.setItem(e.flightKey,e.flightValue.toString())}const At=(e,t,i,n,r)=>e!==Y.tn?Promise.reject("Wrong flow"):new Promise(e=>{const n=t.flightKey,r=t.flightValue;i.logger.ULS.ft(507343134,s.be,o.Info,`setWacFlightValue ${n}: ${r}`),Tt(t),e({completion:"success"})});function Pt(e){const t=window.navigator;if(t&&t.virtualKeyboard&&void 0!==t.virtualKeyboard.overlaysContent&&window===top)return t.virtualKeyboard.overlaysContent=e}const Ft=(e,t,i,s,o)=>e!==Y.Zs?Promise.reject("Wrong flow"):new Promise(e=>{Pt(t.overlayContent),i.container&&i.container.postMessage(ee.Vn,void 0),e({completion:"success"})});function Rt(e){return Ce(e.hostKey)}const Ut=(e,t,i,n,r)=>e!==Y.Us?Promise.reject("Wrong flow"):new Promise(e=>{const n=t.hostKey;i.logger.ULS.ft(574408915,s.B,o.Info,"getHostKeyValue "+n);const r=Rt(t);i.container&&i.container.postMessage(ee.gn,{hostKey:n,hostValue:r}),e({completion:"success"})});function Ot(e){ye(e.hostKey,e.hostValue,365)}const Wt=(e,t,i,n,r)=>e!==Y.io?Promise.reject("Wrong flow"):new Promise(e=>{const n=t.hostKey,r=t.hostValue;i.logger.ULS.ft(574408914,s.B,o.Info,`storeHostKeyValue ${n}: ${r}`),Ot(t),e({completion:"success"})});class xt{Boot(){this.Xi.ULS.ft(596444241,s.B,o.Info,"Initializing WAC frame");const e=It(this.Ic,this.bc,!0),t=function(e,t){const i={};if(e.wopiInfo&&(i[Te.Lr]=e.wopiInfo.AccessToken,i[Te.Vr]=bt(e.wopiInfo),e.wopiInfo.WacToken&&(i[Te.Br]=e.wopiInfo.WacToken)),e.wopiPrecheckInfo.BundleInfo&&e.wopiPrecheckInfo.BundleInfo.Url&&e.wopiPrecheckInfo.BundleInfo.Url.length>0)if(i[Te.$r]=e.wopiPrecheckInfo.BundleInfo.Url,null!=e.wopiPrecheckInfo.BundleInfo.BundleStaleness&&void 0!==e.wopiPrecheckInfo.BundleInfo.BundleStaleness){const n=e.wopiPrecheckInfo.BundleInfo.BundleStaleness.toString();t.ULS.ft(593503580,s.B,o.Info,"Content bundle staleness - "+n),i[Te.Jr]=n}else t.ULS.ft(593503581,s.B,o.Info,"Content bundle staleness does not exist");if(e.wopiPrecheckInfo.FileGetUrl&&(i[Te.Zr]=e.wopiPrecheckInfo.FileGetUrl),e.wopiPrecheckInfo.CustomFontCatalogUrl&&(i[Te.Qr]=e.wopiPrecheckInfo.CustomFontCatalogUrl),e.wopiPrecheckInfo.FileName){const t=se(e.wopiPrecheckInfo.FileName);t&&(i[Te.Xr]=t),i[Te.Yr]=e.wopiPrecheckInfo.FileName}e.newFileTemplateSource&&e.newFileTemplateSource.FileSize?i[Te.ea]=e.newFileTemplateSource.FileSize.toString():e.wopiPrecheckInfo.FileSize&&(i[Te.ea]=e.wopiPrecheckInfo.FileSize.toString()),e.sessionInformation.UserId&&(i[Te.la]=e.sessionInformation.UserId),e.sessionInformation.OwnerId&&(i[Te.na]=e.sessionInformation.OwnerId),e.sessionInformation.SessionContext&&(i[Te.ra]=e.sessionInformation.SessionContext),void 0!==e.sessionInformation.SupportsZipIt&&(i[Te.Ra]=e.sessionInformation.SupportsZipIt.toString()),e.diagnostics.HostInitDiagnostics&&(i[Te.ia]=JSON.stringify({HostInitializeDiagnostics:e.diagnostics.HostInitDiagnostics,ClientDiagnostics:e.diagnostics.ClientDiagnostics})),i[Te.Kr]=re(e.featureManager,e.sessionInformation.WdParams),e.applicationCustomSettings&&e.applicationCustomSettings.HostUIControls&&(i[Te.oa]=JSON.stringify(e.applicationCustomSettings.HostUIControls)),i[Te.ta]=String(window.devicePixelRatio>1.24),i[Te.aa]=String(d()),i[Te.sa]=e.sessionInformation.HostName;const n=e.newFileTemplateSource;n&&n.FileGetUrl&&(i[Te.ca]=n.FileGetUrl),n&&n.DocUniqueId?i[Te.Gr]=n.DocUniqueId:e.wopiPrecheckInfo.DocUniqueId&&(i[Te.Gr]=e.wopiPrecheckInfo.DocUniqueId),n&&n.ETag?i[Te.zr]=n.ETag:e.wopiPrecheckInfo.ETag&&(i[Te.zr]=e.wopiPrecheckInfo.ETag),i[Te.pa]=(new Intl.DateTimeFormat).resolvedOptions().timeZone,"Templatization"!==e.sessionInformation.ContentAssemblyMode&&"DocGen"!==e.sessionInformation.ContentAssemblyMode&&"ContentAssemblyEdit"!==e.sessionInformation.ContentAssemblyMode&&"ContentAssemblyView"!==e.sessionInformation.ContentAssemblyMode||(i[Te.ma]="1"),e.sessionInformation.ContentAssemblyMode&&(i[Te.Aa]=e.sessionInformation.ContentAssemblyMode);const r=e.sessionInformation.Meeting;r&&(r.id&&(i[Te.fa]=r.id),r.title&&(i[Te.wa]=r.title),r.type&&(i[Te.ga]=r.type),r.scheduledStartTime&&(i[Te.Sa]=r.scheduledStartTime),r.scheduledEndTime&&(i[Te.Sa]=r.scheduledEndTime),r.joinUrl&&(i[Te.ba]=encodeURIComponent(r.joinUrl)),r.organizerId&&(i[Te.Ia]=r.organizerId),r.isPresenter&&(i[Te._a]=r.isPresenter.toString()),r.isMeetingTeamsRoom&&(i[Te.Ca]=r.isMeetingTeamsRoom.toString()));const a=e.sessionInformation.OwlVersion;a&&(i[Te.Ea]=a);const c=e.sessionInformation.OwlRollout;c&&(i[Te.Ta]=c);const l=e.sessionInformation.SupportsInPlaceCreateNew;l&&(i[Te.Ua]=l.toString()),e.sessionInformation.DisableEmbedViewCodeSnippet&&(i[Te.Oa]="1"),e.sessionInformation.DisableCoEditInTeams&&(i[Te.Wa]="1"),i[Te.ya]=L();const h=e.sessionInformation.TraceParent;if(h){i[Te.Pa]=h;const t=e.sessionInformation.TraceState;t&&(i[Te.Fa]=t)}return i}(this.Ic,this.Xi);if(this.Cc.registerMessagePayloadHandler(Y.as,this.yc),this.Cc.registerMessagePayloadHandler(Y.us,this.Ec),this.Ic.sessionInformation.SupportsFrameTrustCheck||this.Cc.registerMessagePayloadHandler(Y.As,this.Tc),this.Cc.registerMessagePayloadHandler(Y.Zs,this.Ac),this.Cc.registerMessagePayloadHandler(Y.Us,this.Pc),this.Cc.registerMessagePayloadHandler(Y.io,this.Fc),this.Cc.registerMessagePayloadHandler(Y.tn,this.Rc),this.bc.ignoreWacFramePostMessages||this.Uc(f(e)),this.Oc(e,t),this.bc.ignoreWacFramePostMessages){const e=this.Wc();this.xc(e)}return this.Xi.ULS.ft(595661019,s.B,o.Info,"Created Wac Frame"),this.ic}constructor(e,t,i,n,r,a){if(this.Mc=!1,this.Oc=(e,t)=>{this.Hc.officeFrameCreateTime=G(),this.kc.frameCreateStartTime=this.Hc.officeFrameCreateTime;const i=this.Ic.applicationCustomSettings&&this.Ic.applicationCustomSettings.appFrameName;this.ic=function(e,t,i,s,o,n,r){const a=function(e,t,i){const s=e.ownerDocument.createElement("iframe");s.name=i||"WebApplicationFrame",s.id="WebApplicationFrame",s.src="",s.title="Office Online Frame",s.width="100%",s.height="100%",s.marginWidth="0",s.marginHeight="0",s.style.left="0",s.style.top="0",s.style.right="0",s.style.bottom="0",s.style.display="block",s.style.position="absolute",s.style.backgroundColor="transparent",s.style.border="none",s.frameBorder="0",s.setAttribute("allowfullscreen","true"),s.setAttribute("allowTransparency","true");const o=S(t);return s.setAttribute("allow",`microphone ${o}; autoplay ${o}; camera ${o}; clipboard-read ${o}; clipboard-write ${o}; keyboard-map ${o}; display-capture ${o}`),e.appendChild(s),s}(e,t,r);return pt(t)&&ht(o,"office_form",s,n),gt(o,i,""),function(e,t,i,s){Fe(e,s);const o=t.ownerDocument,n=o.createElement("form");n.id="office_form",n.name="office_form",n.action=i,n.target=e.name,n.method="POST";for(const e in s){const t=o.createElement("input");t.type="hidden",t.name=e,t.value=s[e],n.appendChild(t)}return t.appendChild(n),n.submit(),e}(a,e,t,i)}(this.Ic.container,e,t,this.Ic.featureManager,this.Xi,this.Ic.sessionId,i),this.Cc.activate(this.ic)},this.Uc=e=>{this.Cc.registerMessagePayloadHandler(Y.ls,this.Nc),this.Cc.registerMessagePayloadHandler(Y.ns,this.Dc),this.Pt=window.setTimeout(this.Lc,15e3),this.Vc=new Et(e,this.Ic.Ft,this.Xi,()=>{$(this.Ic.remoteTelemetryUrl,"Excel","bootTimeout")})},this.Rc=e=>{const t=e.flightKey,i=e.flightValue;this.Xi.ULS.ft(507343133,s.be,o.Info,`storeWacFlightKeyValue ${t}: ${i}`);try{Tt(e)}catch(e){this.Xi.ULS.ft(507340380,s.be,o.Error,"Handler error: "+oe(e))}},this.yc=e=>{const t=e&&e.state?e.state:"unknown";this.Xi.ULS.ft(595714271,s.B,o.Info,`WAC Boot App state:[${t}]`),dt(t)},this.Tc=e=>{const t=Re(this.Xi);this.Xi.ULS.ft(595653903,s.B,o.Info,"Top frame is trusted: "+t),this.Bc(ee.As,{isTopFrameTrusted:t})},this.Ac=e=>{const t=Pt(e&&e.overlayContent);this.Xi.ULS.ft(587487432,s.B,o.Info,"Overlay content: "+t),this.Bc(ee.Vn,void 0)},this.Nc=e=>{if(this.Xi.ULS.ft(595986314,s.B,o.Info,"Received wac complete message"),this.Xi.ULS.flush(),window.clearTimeout(this.Pt),this.Vc&&this.Vc.stop(),ut(),this.Mc)return void this.Xi.ULS.ft(596444234,s.B,o.Info,"Received multiple wac complete or failure messages");this.Mc=!0,this.Bc(ee.dn,{}),Ge(this.Hc,e);const t=this.Wc();this.xc(t),this.Ic.Ft.getValue(K.Jt,!1)&&(this.Ic.diagnostics.HostInitDiagnostics||(this.Ic.diagnostics.HostInitDiagnostics={}),fe(this.Ic.diagnostics.HostInitDiagnostics)),this.$c(this.Ic.diagnostics)},this.Ec=()=>{this.Xi.ULS.ft(579342464,s.B,o.Info,"Received close tab message");try{window.close()}catch{this.Xi.ULS.ft(579213188,s.B,o.Warning,"Failed to close the browser tab")}},this.Wc=()=>({innerApplicationFrame:this.ic}),this.Dc=e=>{if(this.Xi.ULS.ft(595986315,s.B,o.Error,"Received wac failed message"),this.Xi.ULS.flush(),window.clearTimeout(this.Pt),this.Vc&&this.Vc.stop(),this.Mc)return void this.Xi.ULS.ft(596444235,s.B,o.Info,"Received multiple wac complete or failure messages");this.Mc=!0,this.Bc(ee.hn,{});const t={errorType:Ne.WacFailed,errorObject:{}};e&&(t.errorObject=e.Error,this.kc.error=t),this.Jc(t)},this.Pc=e=>{const t=e.hostKey;this.Xi.ULS.ft(574433173,s.B,o.Info,"GetHostKeyValue "+t);const i=Rt(e);null!=i&&this.Bc(ee.gn,{hostKey:t,hostValue:i})},this.Fc=e=>{const t=e.hostKey,i=e.hostValue;this.Xi.ULS.ft(574433174,s.B,o.Info,`storeHostKeyValue ${t}: ${i}`),Ot(e)},this.Lc=()=>{this.Mc||this.Xi.ULS.ft(596444236,s.B,o.Warning,"Timeout. SessionTraces:"+JSON.stringify(this.kc))},this.$c=e=>{this.Bc(ee.vn,{HostInitializeDiagnostics:e.HostInitDiagnostics,ClientDiagnostics:e.ClientDiagnostics})},this.Bc=(e,t)=>{this.ic&&this.ic.contentWindow?this.Cc.sendPostMessage(this.ic,e,t):this.Xi.ULS.ft(595955718,s.B,o.Info,"Attempted to send postmessage: "+e)},void 0===t)throw new TypeError("bootFlowInfo");if(t.isSingleStepBoot&&void 0===e.wopiInfo)throw new TypeError("wopiInfo");this.Ic=e,this.bc=t,this.Xi=i,this.Cc=n,this.xc=r,this.Jc=a,this.Hc=e.diagnostics.AppInitDiagnostics,this.kc=e.diagnostics.SessionTraces,this.kc.wopiInitializeTime=G()}}class Mt{Complete(e,t){if(this.Gc)this.Xi.ULS.ft(596444184,s.B,o.Warning,"Complete called after Complete/Fail already called");else{this.Xi.ULS.ft(596444185,s.B,o.Info,"Complete called."),this.Ic.diagnostics.HostInitDiagnostics&&(this.Ic.diagnostics.HostInitDiagnostics.hostCompleteCallTime=G()),this.Gc=!0,this.jc=e,this.kc.wopiPendingCompleteTime=G();try{this.bc.isSingleStepBoot?this.qc():this.zc(),this.Kc&&this.Bc(ee.Bn,{}),this.Xc(t)}catch(e){this.Xi.ULS.ft(596444186,s.B,o.Error,"Unexpected script error: "+oe(e)),$(this.Ic.remoteTelemetryUrl,"Excel","bootException")}finally{this.Xi.ULS.flush()}}}Fail(e){this.Gc?this.Xi.ULS.ft(596444187,s.B,o.Warning,"Fail called after Complete/Fail already called"):(this.Xi.ULS.ft(596444188,s.B,o.Warning,"Fail called. Reason: "+(e?JSON.stringify(e):"N/A")),this.Gc=!0,this.bc.isSingleStepBoot?this.Zc():this.Qc(e),this.Xi.ULS.flush())}Dispose(e,t,i){He(e||!1,this.Xi,this.Cc,this.ic,()=>{delete this.ic,t&&t(),this.Yc(),this.Cc.dispose()},void 0,i)}PostWacToken(e,t,i){!function(e,t,i,n,r,a){const c=G();n.ULS.ft(507774684,s.B,o.Important,"postWacToken flow initiated");const l=()=>{a&&a.flush&&a.flush()};r?r.then(r=>{const h=()=>i.sendPostMessage(r,ee.er,{wacToken:e,postWacTokenStart:t});h();const d=window.setInterval(h,100);i.registerMessagePayloadHandler(Y.Zo,e=>{n.ULS.ft(507597019,s.B,o.Info,`postWacToken flow completed in ${G()-c} ms`),window.clearInterval(d),window.clearTimeout(u),a&&(a.PostWacTokenResult="success",a.PostWacTokenEndTime=G(),e&&void 0!==e.TokenAlreadySet&&(a.TokenAlreadySet=e.TokenAlreadySet),l())});const u=window.setTimeout(()=>{n.ULS.ft(507597018,s.B,o.Warning,"postWacToken flow timed out after 60000 ms"),window.clearInterval(d),a&&(a.PostWacTokenResult="timeout",a.PostWacTokenEndTime=G(),l())},6e4)}).catch(e=>{n.ULS.ft(507873094,s.B,o.Warning,"This should never reject, error: "+oe(e)),a&&(a.PostWacTokenResult="Unexpected JSAPI V1 error",a.PostWacTokenEndTime=G(),l())}):(n.ULS.ft(507846862,s.B,o.Warning,"`Promise` does not exist natively for this browser."),a&&(a.PostWacTokenResult="JSAPI V1 error: Promise not supported in browser",a.PostWacTokenEndTime=G(),l()))}(e,t,this.Cc,this.Xi,this.tl,i)}Boot(){this.bc.isSingleStepBoot||this.il(),this.Xi.ULS.flush()}constructor(e,t,i,n,r,a,c){this.Kc=!1,this.ol=!1,this.Gc=!1,this.rl=null,this.al=!0,this.cl=!1,this.ll=!1,this.il=()=>{this.Xi.ULS.ft(596444231,s.B,o.Info,"Initializing Office frame WITHOUT WOPI info - first step of two step flow."),window.setTimeout(this.hl,5e3),this.Cc.registerMessagePayloadHandler(Y.os,this.dl),this.Cc.registerMessagePayloadHandler(Y.Xs,this.ul);const e=new xt(this.Ic,this.bc,this.Xi,this.Cc,this.xc,this.Jc);this.ic=e.Boot(),this.ml&&this.ml(this.ic)},this.zc=()=>{const e={ParallelizeStartSession:this.al,WacFrameIsLoaded:this.Kc,WacAcceptsStartSessionComplete:this.cl};this.Xi.ULS.ft(596444232,s.B,o.Info,"Completing the initialized application WITH the WOPI info - second step of two step flow. Current app state - "+JSON.stringify(e)),!this.al||this.Kc&&!this.cl?this.Kc&&this.fl():this.wl()},this.qc=()=>{this.Xi.ULS.ft(596444233,s.B,o.Info,"Initializing Office frame WITH WOPI info - single step WOPI boot flow."),this.Ic.wopiInfo=this.jc;const e=new xt(this.Ic,this.bc,this.Xi,this.Cc,this.xc,this.Jc);this.ic=e.Boot(),this.ml(this.ic)},this.Qc=e=>{this.Kc?(this.Xi.ULS.ft(595968481,s.B,o.Warning,"Fail called and wacframe is able to accept postmessages"),this.gl(e)):(this.Xi.ULS.ft(595968482,s.B,o.Warning,"Fail was called on the session prior to WacReady."),this.rl=e)},this.gl=e=>{this.Xi.ULS.ft(596444189,s.B,o.Warning,"Fail called, sending the failure postmessage to IFrame"),this.Bc(ee.Ln,e)},this.Zc=()=>{this.Xi.ULS.ft(596444190,s.B,o.Warning,"Fail called during single step boot, calling host failure callback..."),this.Jc({errorType:Ne.InvalidWopiInfo,errorObject:new TypeError("wopiInfo")})},this.hl=()=>{this.Kc||(this.Xi.ULS.ft(596444191,s.B,o.Warning,"Timeout Wac Ready"),this.Jc({errorType:Ne.TimeoutWacReady,errorObject:void 0}))},this.vl=()=>{this.Gc||(this.kc.timeoutCompleteOrFail=G(),this.Xi.ULS.ft(596444192,s.B,o.Warning,"Timeout Complete or Fail. SessionTraces:"+JSON.stringify(this.kc)))},this.Sl=(e,t,i)=>{this.ll||(this.Xi.ULS.ft(596444193,s.B,o.Info,"SessionCompletion timed out with no ack."),this._l(e,t,i+1))},this.dl=e=>{if(this.kc.readyMessageReceiveTime=G(),this.Bc(ee.an,{}),this.Kc)return void this.Xi.ULS.ft(596444194,s.B,o.Info,"Received multiple ready messages - frame is already loaded.");this.Kc=!0,this.cl=e&&e.CanAcceptStartSessionComplete;const t={AcceptStartSessionComplete:this.cl,ParallelizeStartSession:this.al,StartSessionResponseAvailable:!!this.Il,WopiInfoAvailable:!!this.jc};this.Xi.ULS.ft(596444195,s.B,o.Info,"HandleWacReadyMessage - "+JSON.stringify(t)),this.Gc&&(this.rl?this.gl(this.rl):this.Bc(ee.Bn,{})),this.al&&this.cl?this.Il&&this.bl():this.jc&&this.fl(),Ge(this.Hc,e)},this.ul=e=>{this.ll=!0,this.kc.sessionCompleteAckReceivedTime=G()},this.Bc=(e,t)=>{this.Cc.sendPostMessage(this.ic,e,t)},this.Cl=(e,t)=>{this._l(e,t,1)},this._l=(e,t,i)=>{if(i>3)return void this.Xi.ULS.ft(596444224,s.B,o.Error,"Attempted to call complete, but received no ack from the frame. Time: "+G());this.Xi.ULS.ft(596444225,s.B,o.Info,`Sending completion message to frame. Attempt number: ${i}, Time: ${G()}`);const n=G();1===i&&(this.Il&&this.Il.Diagnostics&&(this.Il.Diagnostics.completeMessageCreateTime=n),this.kc.completeMessageCreateTime=n),t.Diagnostics.completeMessageSendTime=n,this.kc.completeMessageSendTime=n,this.Bc(e,t),window.setTimeout(()=>this.Sl(e,t,i),1e3)},this.wl=()=>{this.Xi.ULS.ft(596444226,s.B,o.Info,"Making parallelized startSession request.");const e=this.yl(this.jc),t="access_token="+encodeURIComponent(this.jc.AccessToken)+"&access_token_ttl="+encodeURIComponent(bt(this.jc));this.kc.startSessionStartTime=G(),function(e,t,i,s){const o=new XMLHttpRequest;o.onreadystatechange=()=>{if(o&&4===o.readyState){if(void 0===o.status||0===o.status)return;try{s&&s(o)}finally{null!=o&&(o.onreadystatechange=()=>{})}}},o.open("POST",e);for(const e in i)o.setRequestHeader(e,i[e]);o.send(t)}(e,t,{"Content-Type":"application/x-www-form-urlencoded"},this.El)},this.El=e=>{if(this.kc.startSessionCompleteTime=G(),this.kc.startSessionResponseStatus=e.status,this.Il={StartSessionResponse:{RequestStatus:e.status,ResponseText:e.responseText},Diagnostics:{wopiPendingInitializeTime:this.kc.wopiPendingInitializeTime,wopiPendingCompleteTime:this.kc.wopiPendingCompleteTime,startSessionStartTime:this.kc.startSessionStartTime,startSessionCompleteTime:this.kc.startSessionCompleteTime,readyMessageReceiveTime:this.kc.readyMessageReceiveTime}},this.Xi.ULS.ft(596444227,s.B,o.Info,`StartSession request completed with status code: ${this.Il.StartSessionResponse.RequestStatus}, Time: ${G()}`),this.Kc&&this.cl)return void this.bl();const t={WacFrameIsLoaded:this.Kc,InitializeCompleted:this.ol};this.Xi.ULS.ft(596444228,s.B,o.Info,"StartSessionCompleted not called - "+JSON.stringify(t))},this.fl=()=>{if(this.ol)return;this.ol=!0,this.Xi.ULS.ft(596444229,s.B,o.Info,"Sending wopi info to the frame.");const e={WopiDetails:{WopiSrc:this.jc.WopiSrc,AccessToken:this.jc.AccessToken,AccessTokenTtl:bt(this.jc)},Diagnostics:{wopiPendingInitializeTime:this.kc.wopiPendingInitializeTime,wopiPendingCompleteTime:this.kc.wopiPendingCompleteTime,readyMessageReceiveTime:this.kc.readyMessageReceiveTime}};this.jc.WacToken&&(e.WopiDetails.WacToken=this.jc.WacToken),this.Cl(ee.pn,e)},this.bl=()=>{200===this.Il.StartSessionResponse.RequestStatus?this.ol||(this.ol=!0,this.Cl(ee.un,this.Il)):this.fl()},this.yl=e=>{let t=this.Ic.applicationBasePath+"wordeditorstartsession.ashx";const i=It(this.Ic,this.bc,!1);return t+="?"+i.substring(i.indexOf("?")+1),t=y(t,"WOPISrc",encodeURIComponent(e.WopiSrc)),t=y(t,"build",encodeURIComponent(L())),t=y(t,"WacUserType",encodeURIComponent("WOPI")),this.Ic.wopiPrecheckInfo.FileGetUrl&&(t=y(t,"fileGetUrlPresent","1")),t},this.Xc=e=>{if(this.Ic.isCreateNew){if(!e||!e.NewFilePath)return void this.Xi.ULS.ft(596444230,s.B,o.Info,"Either NewFileInfo or NewFilePath are not provided for a new file.");history.replaceState({},"",e.NewFilePath),e.UpdatedPageTitle&&(document.title=e.UpdatedPageTitle)}},this.Ic=e,this.bc=t,this.Hc=e.diagnostics.AppInitDiagnostics,this.Xi=i,this.Cc=n,this.xc=a,this.Jc=c,Promise&&(this.tl=new Promise(e=>this.ml=e)),this.kc=e.diagnostics.SessionTraces,this.kc.wopiPendingInitializeTime=G(),this.Yc=r,Me(),window.setTimeout(this.vl,5e3)}}class Ht{registerEventHandler(e){this.ec.push(e)}removeEventHandler(e){if(e){const t=this.ec.indexOf(e);this.ec.splice(t,1)}}stop(){document.removeEventListener("visibilitychange",this.Tl)}getVisibilityChangeEvents(){return this.Al}dispose(){this.stop(),this.ec=[],this.Al=[]}constructor(){if(this.Al=[],this.ec=[],this.Tl=()=>{const e={visibility:document.visibilityState,time:G(),initialState:!1};this.Al.push(e);for(const t of this.ec)t&&t(e)},"hidden"===document.visibilityState){const e={visibility:document.visibilityState,time:G(),initialState:!0};this.Al.push(e)}document.addEventListener("visibilitychange",this.Tl)}}const kt=[];function Nt(e){window.performance&&window.performance.getEntriesByType&&window.addEventListener("load",()=>{try{for(const t of window.performance.getEntriesByType("resource")){const i=A(t.name);if("about:blank"!==t.name&&-1===i.indexOf("RemoteUls.ashx")&&-1===i.indexOf("mhtml:file"))if("excel-boot.min.js"===i){let n=JSON.stringify(t);n=n.replace(new RegExp(t.name,"g"),i),e.ULS.ft(574662801,s.B,o.Info,n)}else if(-1!==kt.indexOf(i)){let n=JSON.stringify(t);n=n.replace(new RegExp(t.name,"g"),i),e.ULS.ft(595736532,s.B,o.Info,n)}}try{const t=window.performance.getEntriesByType("navigation");let i;i=t.length>0?t[0].type||"UndefinedType":"none",e.ULS.ft(555872898,s.B,o.Info,"Navigation type is: "+i)}catch(t){e.ULS.ft(556011586,s.B,o.Info,"ExcelPreloader.tryObserveResourceTiming: Exception thrown when trying to read navigation type. Exception: "+JSON.stringify(t))}window.performance.clearResourceTimings()}catch(t){e.ULS.ft(595732049,s.B,o.Info,"ExcelPreloader.tryObserveResourceTiming: could not trace resource timing, error is: "+JSON.stringify(t))}},{once:!0})}let Dt,Lt;function Vt(e,t,i){Dt=e;try{if(i){const e=(e,t)=>{Bt(t)};i.addActionHandler(Y.vo,e)}else t&&t.registerMessagePayloadHandler(Y.vo,e=>{Bt(e)})}catch(e){Dt.ULS.ft(572383452,s.B,o.Warning,"ExcelFileBundleRegenerationRequester.initRegenerateFileBundleMessageHandler: "+oe(e))}}function Bt(e){if(e&&e.hasOwnProperty("fileUrl")&&e.hasOwnProperty("fileType"))try{const t=function(){const e=new Jt,t=new XMLHttpRequest;return t.timeout=3e4,t.withCredentials=!0,t.onreadystatechange=function(){t.readyState===XMLHttpRequest.DONE&&(200===t.status?(e.IsSucceeded=!0,e.HostCorrelationId=function(e){let t=null;try{var i;const s=(new window.DOMParser).parseFromString(e,"text/xml");t=new URL(null!==(i=s.documentElement.textContent)&&void 0!==i?i:"").searchParams.get("correlationId")}catch(e){Dt.ULS.ft(572383454,s.B,o.Warning,"ExcelFileBundleRegenerationRequester.readSpoCorrelationFromResponse: "+oe(e))}return t}(t.responseText)):e.FailureReason="XhrHttp"+t.status,$t(e))},t.onerror=function(t){e.FailureReason="XhrError",$t(e)},t}(),i=function(e){const t=new URL(e.fileUrl).origin,i=new URL(t);return i.pathname="_api/SP.Utilities.WOPIHostUtility.GenerateFileBundle",i.searchParams.set("fileUrl",e.fileUrl),i.searchParams.set("fileType",e.fileType),i}(e);t.open("GET",i.toString(),!0),t.send()}catch(e){Dt.ULS.ft(572381152,s.B,o.Warning,"ExcelFileBundleRegenerationRequester.handleRegenerateFileBundleMessage: "+oe(e))}else Dt.ULS.ft(572383453,s.B,o.Warning,`ExcelFileBundleRegenerationRequester.handleRegenerateFileBundleMessage: Message is missing parameter(s). values=null? ${!e},\n        fileUrl=null? ${e&&!e.hasOwnProperty("fileUrl")}, fileType=null? ${e&&!e.hasOwnProperty("fileType")}`)}function $t(e){Dt.ULS.ft(572383455,s.B,o.Warning,"ExcelFileBundleRegenerationRequester.logResult: "+JSON.stringify(e))}class Jt{constructor(){this.IsSucceeded=!1,this.HostCorrelationId=null,this.FailureReason=null}}function Gt(e,t,i){Lt=e;const n=e=>{e.forEach(e=>{e?function(e,t,i){if(!Re(Lt))return;const n="addqsp"===(null==e?void 0:e.toLowerCase()),r="removeqsp"===(null==e?void 0:e.toLowerCase());t?n?jt(!0,!1,t,i):r?jt(!1,!0,t,i):Lt.ULS.ft(508864545,s.B,o.Error,"Does not contain expected values."):Lt.ULS.ft(508864546,s.B,o.Warning,"handleHostFrameModifyURLState: qspName is null.")}(e.ops,e.qspName,e.qspValue):Lt.ULS.ft(508864544,s.B,o.Warning,"handleHostFrameModifyURLState: MessageData is null.")})};try{if(i){const e=(e,t)=>{n(t)};i.addActionHandler(Y.Xo,e)}else t&&t.registerMessagePayloadHandler(Y.Xo,e=>{n(e)})}catch(e){Lt.ULS.ft(508864547,s.B,o.Error,"ExcelModifyURLStateManager: error while initializing.")}}function jt(e,t,i,n){const r=new URLSearchParams(window.location.search);e&&n?null==r||r.set(i,n):t&&(null==r||r.delete(i));try{window.history.replaceState({},"",window.location.origin+window.location.pathname+"?"+r.toString()),Lt.ULS.ft(508864543,s.B,o.Info,` ${e?"Added":"Removed"} querystring param from url of hostframe`)}catch(e){Lt.ULS.ft(508864542,s.B,o.Warning,"ExcelModifyURLStateManager: error while changing state of hostframe:\n        "+oe(e))}}function qt(e){e.ULS.ft(590914655,s.B,o.Info,"Time spent logging: "+e.getTimeSpentLogging())}function zt(e){return{...e.AppInitDiagnostics,...e.HostInitDiagnostics,SessionTraces:e.SessionTraces}}var Kt;!function(e){e.BrowserEvent="BrowserEvent",e.AcquireOAuthTokenTeams="AcquireOAuthTokenTeams",e.PageChanged="PageChanged",e.ZoomChanged="ZoomChanged",e.ContentRefreshBegin="ContentRefreshBegin",e.ContentRefreshEnd="ContentRefreshEnd",e.AppClosed="UI_Close",e.UserEdit="Edit_Notification",e.FileRename="File_Rename",e.FileShare="UI_Sharing",e.ShowFileVersions="UI_FileVersions",e.UIWorkflow="UI_Workflow",e.IsDisabled="IsDisabled",e.AccessibilityLoopComplete="App_AccessibilityLoopComplete",e.Unloaded="Unloaded",e.Disposed="Disposed",e.SwitchMode="App_SwitchMode",e.DocumentReboot="DocReboot",e.WopiInfoFromUrl="WopiInfoFromUrl",e.DavUrlFromIds="DavUrlFromIds",e.ModeSwitched="ModeSwitched",e.CreateNewDocument="App_CreateNewDocument",e.GetAuthToken="GetAuthToken",e.GetCustomAuthConfig="GetCustomAuthConfig",e.SetOverlayContent="SetOverlayContent",e.MoveToFolder="MoveToFolder",e.SharedFilePicker="SharedFilePicker"}(Kt||(Kt={}));class Xt{GetApplicationType(){return"Excel"}GetVersion(){return L()}GetSessionId(){return this.Pl}RegisterEventHandler(e,t){switch(e){case Kt.Unloaded:case Kt.Disposed:case Kt.DocumentReboot:case Kt.WopiInfoFromUrl:case Kt.DavUrlFromIds:case Kt.GetAuthToken:case Kt.GetCustomAuthConfig:case Kt.MoveToFolder:case Kt.SharedFilePicker:case Kt.SetOverlayContent:case Kt.FileShare:if(this.ec[e])throw new Error("Duplicate registration");this.ec[e]=t;break;default:this.Cc.registerMessagePayloadHandler(e,t)}}RemoveEventHandler(e,t){switch(e){case Kt.Unloaded:case Kt.Disposed:case Kt.DocumentReboot:case Kt.FileShare:case Kt.WopiInfoFromUrl:case Kt.DavUrlFromIds:case Kt.GetAuthToken:case Kt.GetCustomAuthConfig:case Kt.MoveToFolder:case Kt.SharedFilePicker:case Kt.SetOverlayContent:if(this.ec[e]!==t)throw new Error("The handler requested to be removed does not exist for the eventType");delete this.ec[e];break;default:this.Cc.removeMessageHandler(e)}}RegisterErrorHandler(e){}RemoveErrorHandler(e){}PostCommand(e,t){this.Cc.postMessageForCommand(this.ic,e,t)}Dispose(e,t){He(e||!1,this.Xi,this.Cc,this.ic,()=>{delete this.ic,this.Fl(),this.Cc.dispose(),this.Rl(Kt.Unloaded,{})},()=>{try{this.Rl(Kt.Disposed,{}),this.ec={}}catch(e){this.Xi.ULS.ft(589108815,s.B,o.Error,"onFrameRemoved error: "+oe(e))}},t)}constructor(e,t,i,n,r){this.ec={},this.Ul=()=>{this.Cc.registerMessagePayloadHandler(Y.$s,this.Ol),this.Cc.registerMessagePayloadHandler(Y.Os,this.Wl),this.Cc.registerMessagePayloadHandler(Y.Ws,this.xl),this.Cc.registerMessagePayloadHandler(Y.Fs,this.Ml),this.Cc.registerMessagePayloadHandler(Y.Qs,this.Hl),this.Cc.registerMessagePayloadHandler(Y.Rs,this.kl),this.Cc.registerMessagePayloadHandler(Y.Hs,this.Nl),this.Cc.registerMessagePayloadHandler(Y.zs,this.Dl)},this.Rl=(e,t)=>{const i=this.ec[e];if(i)try{i(t||{})}catch(e){this.Xi.ULS.ft(593773706,s.B,o.Error,"Handler error: "+oe(e))}},this.Ol=e=>{e.previousSessionId=this.Pl,this.Rl(Kt.DocumentReboot,e)},this.Wl=e=>{this.Rl(Kt.WopiInfoFromUrl,e)},this.xl=e=>{this.Rl(Kt.DavUrlFromIds,e)},this.Ml=e=>{Promise?this.Ll.isResourceTrustedForMessage(e).then(t=>{t?this.Rl(Kt.GetAuthToken,e):this.Cc.sendPostMessage(this.ic,ee.Rn,{AuthToken:"",Error:"accessDenied",RequestId:e.RequestId,IdentityType:e.IdentityType})},()=>{this.Cc.sendPostMessage(this.ic,ee.Rn,{AuthToken:"",Error:"Exception encountered in AuthTokenTrustValidator.isResourceTrustedForMessage",RequestId:e.RequestId,IdentityType:e.IdentityType})}):this.Cc.sendPostMessage(this.ic,ee.Rn,{AuthToken:"",Error:'"Promise" does not exist natively in browser',RequestId:e.RequestId,IdentityType:e.IdentityType})},this.Hl=e=>{this.Rl(Kt.FileShare,e)},this.kl=e=>{this.Rl(Kt.GetCustomAuthConfig,e)},this.Nl=e=>{this.Rl(Kt.MoveToFolder,e)},this.Dl=e=>{this.Rl(Kt.SharedFilePicker,e)},this.Pl=e,this.Xi=t,this.ic=r.innerApplicationFrame,this.Cc=i,this.Fl=n,this.Ll=new Se(t),this.Ul(),Me()}}function Zt(e,t,i){return Qt(i)&&Xe(e)&&!Yt(t)}const Qt=function(e){try{var t;const i=["OutlookMobileAndroid","OutlookMobileiOS","OutlookIpad","OutlookAndroidTablet"];if(null!=e&&null!==(t=e.host)&&void 0!==t&&t.uiHostName&&i.includes(e.host.uiHostName)){let t="";t="OutlookMobileiOS"===e.host.uiHostName||"OutlookIpad"===e.host.uiHostName?"Microsoft.Office.Excel.PreloadCoreResourcesFromJsapiIos":"Microsoft.Office.Excel.PreloadCoreResourcesFromJsapiAndroid";const i=localStorage.getItem(t);null!==i&&window.setTimeout(()=>localStorage.removeItem(t),10);const n="true"===(null==i?void 0:i.toString());return e.logger.ULS.ft(505013397,s.B,o.Important,"ShouldPreloadCoreResourcesForPreviewer: "+n+"; UIHost: "+e.host.uiHostName),n}}catch(t){null==e||e.logger.ULS.ft(505013396,s.B,o.Error,"ShouldPreloadForMobilePreviewer exception: "+t)}return!0},Yt=function(e){return[n.Chrome,n.Edge].includes(c())&&(!e||"https://onedrive.live.com"!==e.toLowerCase())};function ei(e,t,i,n,r){let a={};if(r)a=r;else try{a=JSON.parse("###JSAPIHASHES###")}catch(e){n&&n.ULS.ft(589178847,s.B,o.Info,"GetExcelResources failed to parse hash dictionary")}let c="";try{const t=S(e);c=t.includes("res")?t+"/officeonline/x/s/":P(t+"/x/s/"),!t.includes("res")&&Ke.some(e=>t.includes(e))&&(c=t.includes("c5")?"https://res.df.onecdn.static.microsoft/officeonline/x/s/":t.includes("c4")?"https://res.public.onecdn.static.microsoft/officeonline/x/s/":"https://res-1.cdn.office.net/officeonline/x/s/"),n&&n.ULS.ft(505278556,s.B,o.Info,"GetExcelResources: ResourceBase url: "+c)}catch(t){c=P(S(e)+"/x/s/"),n&&n.ULS.ft(505280017,s.B,o.Error,"GetExcelResources: Error in building resourceBase: "+t)}const l=function(e){const t=e?e.toLowerCase().split("-")[0]:"en";return x[t]}(null!=t?t:"en-US"),h=function(e){let t=[["App_Scripts/EwaTS.js",!1],["App_Scripts/gridRenderer.min.js",!1],["App_Scripts/MicrosoftAjaxDS.js",!1],["App_Scripts/EwaTS.bootCommon.js",!1]];return e&&(t=t.concat([[`App_Scripts/${e}/Ewa.Strings.Wac.js`,!0],[`Resources/${e}/EwrDefault.css`,!0],[`Resources/${e}/excelframe.css`,!0]])),t}(l),d=[];for(const[e,t]of h){const i=e.substring(e.lastIndexOf("/")+1);if(kt.push(i),t&&"1033"!==l)continue;const r=i.toLowerCase();if(console.log("lowerCaseFile"),a&&a[r]){const t=a[r].UrlHash,l=a[r].SriHash;if(t&&l){const r=c+t+"__layouts/"+e;d.push([r,"sha256-"+l]),n&&n.ULS.ft(589178849,s.B,o.Info,"GetExcelResources adding hashed url for "+i)}}}let u="";for(const e of d)u+=e[0]+", ";return n&&d.length>0&&n.ULS.ft(505278555,s.B,o.Important,"GetExcelResource urls: "+u),d}const ti=(e,t,i,n,r)=>e!==Y.$s?Promise.reject("Wrong flow"):new Promise(e=>{i.pendingReboot=!0;let n=void 0;if(t.queryOverrides)try{n=JSON.parse(t.queryOverrides)}catch(e){i.logger.ULS.ft(592217694,s.B,o.Error,"Failed to parse queryOverrides: "+n)}i.raiseEvent(te.Reboot,{...t,previousSessionId:i.sessionId,queryOverrides:n}),e({completion:"success"})});function ii(e){var t;const i={};I(i,"jsapi","1"),I(i,"jsapiver","v2"),I(i,"corrid",e.sessionId),I(i,"usid",e.sessionId),I(i,"newsession","1"),I(i,"sftc","1"),e.hostSessionId&&I(i,"hid",encodeURIComponent(e.hostSessionId));const s=e.host;s.uiHostName&&I(i,"uih",s.uiHostName),s.uiHostIntegrationType&&I(i,"uihit",encodeURIComponent(s.uiHostIntegrationType)),s.metaUiHostVersion&&I(i,"muv",encodeURIComponent(s.metaUiHostVersion)),s.topOrigin&&I(i,"to",encodeURIComponent(s.topOrigin)),s.isDeeplyNestedAuthSupportedInTeams&&I(i,"dnaa","1");const o=s.capabilities;o&&(o.accessibilityLoop&&I(i,"accloop","1"),o.rebootDoc&&I(i,"sdr",o.rebootDoc.toString()),o.createNewDoc&&I(i,"scnd","1"),o.authToken&&I(i,"sat","1"),window.docAspxMsalEnabled&&"onedrivecom"!==s.uiHostName&&(o.authTokenStrategy="PairwiseBroker"),o.authTokenStrategy&&I(i,"ats",o.authTokenStrategy),o.customAuthConfig&&I(i,"cac","1"),o.refreshAccessToken&&I(i,"rat","1"),o.atMentions&&I(i,"sams","1"),o.moveToFolder&&I(i,"mtf","1"),o.noBrowserModalDialogs&&I(i,"nbmd","1"),o.commonFilePicker&&I(i,"sfp","1"),o.directDownload&&I(i,"sdd","1"),o.directPrint&&I(i,"sdp","1"),o.disableOfficeAddins&&I(i,"doa","1"));const n=e.ui;n.language&&I(i,"ui",encodeURIComponent(n.language)),n.uiEmbed&&I(i,"uiembed","1"),(n.hideHeader||"DocGen"===n.contentAssemblyMode||"Templatization"===n.contentAssemblyMode||"ContentAssemblyEdit"===n.contentAssemblyMode||"ContentAssemblyView"===n.contentAssemblyMode)&&I(i,"hhdr","1"),n.highContrast&&I(i,"hcm",encodeURIComponent(n.highContrast)),n.hideFileLocationPicker&&I(i,"hodflp","1"),n.hideAppLauncherInHeader&&I(i,"halh","1"),n.hideChatInHeader&&I(i,"hch","1"),n.hideMeInHeader&&I(i,"hmh","1"),n.hideSearchInHeader&&I(i,"hsh","1"),n.hideWorkflowInHeader&&I(i,"hwfh","1"),n.hideSettingsInHeader&&I(i,"hsth","1"),n.showAppIconInHeader&&I(i,"sih","1"),n.useNeutralColorInHeader&&I(i,"unh","1"),n.openLinksInNewWindow&&I(i,"onw","1"),n.useDarkTheme&&I(i,"udt","1"),"DocGen"!==n.contentAssemblyMode&&"ContentAssemblyView"!==n.contentAssemblyMode||I(i,"readOnly","1");const r=e.wopi;r&&r.source&&I(i,"wopisrc",encodeURIComponent(r.source));const a=e.bootParams;a&&(a.dataLanguage&&I(i,"rs",encodeURIComponent(a.dataLanguage)),a.readOnly&&(I(i,"readonly","1"),I(i,"mode","Read")),a.disableChat&&I(i,"dchat","1"),a.cookieCompliant&&I(i,"mscc","1"),a.isNewFile&&(I(i,"new","1"),a.isFromHostTemplate&&I(i,"wdtpl","fromhost"))),e.user.isLicensed&&I(i,"islicenseduser","1"),e.user.isSynthetic&&I(i,"syn","1"),e.actNavId&&I(i,"actnavid",e.actNavId),e.sessionContext&&I(i,"sc",encodeURIComponent(e.sessionContext));const c=e.wdParams;if(c)for(const e in c)I(i,e,c[e]);const l=e.preseededSession;l&&(l.key&&I(i,"preseededsessionkey",encodeURIComponent(l.key)),l.id&&I(i,"preseededwacsessionid",encodeURIComponent(l.id)));const h=e.throttling;h&&(h.protection&&I(i,"ctp",h.protection),h.request&&I(i,"rct",h.request));const d=e.hostInitDiagnostics;d&&(d.entryPoint&&I(i,"wdorigin",encodeURI(d.entryPoint)),d.userClickTime&&I(i,"wdhostclicktime",d.userClickTime.toString()));const u=e.rebootOverride;return u&&u.previousSessionId&&I(i,"wdprevioussession",u.previousSessionId),b(i,"region"),null!==(t=e.bootParams)&&void 0!==t&&t.afdFlighting&&I(i,"afdflight",Math.floor(100*Math.random()+1).toString()),i}const si=(e,t,i,n,r)=>e!==Q.boot?Promise.reject("Wrong flow"):new Promise(e=>{const a=G();var c,l;i.state=k.Booting,i.pendingReboot=!1,function(e,t,i=!1){if(!e)throw new TypeError("SessionBootParams");const s=e.appUrl,o=e.appBaseUrl;if(!s&&!o)throw new TypeError("Either appUrl or appBaseUrl should exist");if(s&&"string"!=typeof s)throw new TypeError("AppUrl");if(o&&"string"!=typeof o)throw new TypeError("AppBaseUrl");const n=e.file;if(!n||!i&&!n.name)throw new TypeError("FileInfo");const r=e.container;if(!r||!(r instanceof Ue)&&!r.appendChild)throw new TypeError("Container");if(!(t||(a=e.wopi)&&a.source&&a.accessToken&&(a.expiry||0===a.expiry)))throw new TypeError("WopiInfo");var a}(t,i.skipWopiValidation,i.skipFileNameCheck),i.intent=t.intent,i.file=t.file,i.customFontCatalogUrl=t.customFontCatalogUrl,i.wopi=t.wopi,i.contentBundle=t.contentBundle,i.newFileTemplate=t.newFileTemplate,i.ownerId=t.ownerId,i.sessionContext=t.sessionContext,i.actNavId=t.actNavId,i.preseededSession=t.preseededSession,i.throttling=t.throttling,i.meeting=t.meeting,i.tenantId=t.tenantId,i.wdParams=(c=t.wdParams,function(e,t){const i={};return t&&Object.keys(t).forEach(e=>{i[e.toLowerCase()]=t[e]}),e.split("&").forEach(e=>{if(/^wd\w+=.+/i.test(e)){const t=e.split("=");i[t[0].toLowerCase()]=t[1]}}),i}((null===(l=window.location.search)||void 0===l?void 0:l.substring(1))||"",c)),i.pinnedTarget=t.pinnedTarget,i.rebootOverride=t.rebootOverride,i.bootParams=t.bootParams||{},i.hostInitDiagnostics={...t.diagnostics,hostInitializeCallTime:a};let h=!1;const u=i.preseededSession;i.appInfo.usePreseededSessionId&&u&&u.id&&(i.sessionId=u.id,h=!0);let p=!1;const m=t.hostGeneratedSessionId;if(!h&&m&&(i.sessionId=m,p=!0),i.Ft.getValue(K.Jt,!1)&&fe(i.hostInitDiagnostics),t.appUrl){const e=t.appUrl;i.appUrl=e;const s=i.bootParams;if(F(e,"new")&&(s.isNewFile=!0),!s.dataLanguage){const t=R(e,"rs");t&&(s.dataLanguage=t)}const o=i.ui;if(F(e,"uiembed")&&(o.uiEmbed=!0),!o.language){const t=R(e,"ui");t&&(o.language=t)}if(!i.hostInitDiagnostics.entryPoint){const t=R(e,"wdorigin");t&&(i.hostInitDiagnostics.entryPoint=t)}if(!i.host.uiHostName){const t=R(e,"uih");t&&(i.host.uiHostName=t)}}else i.appUrl="";let w;if(i.appBaseUrl=t.appBaseUrl?t.appBaseUrl.toLowerCase():S(t.appUrl).toLowerCase(),i.appBaseUrl=v(i.appBaseUrl,C(i.appUrl,"region")),i.Ft.updateEnvironment(i.appBaseUrl),n.initializeAppContext(i,e,t),i.appBasePath=n.buildAppBasePath(i),t.rebootOverride&&(h||p||([i.sessionId,w]=he()),i.pageStateObserver=new we(i.logger,!0),i.authTokenTrustValidator=new Se(i.logger)),i.logger.ULS.ft(38580693,s.B,o.Info,`User session id: ${i.sessionId}, is preseeded: ${h}, is host generated: ${p}`),i.remoteTelemetryUrl=n.buildRemoteTelemetryUrl(i),$(i.remoteTelemetryUrl,i.appInfo.name,"init"),!i.isLoggerFromOwl){let e=i.Ft.getValue(K.Wt,"").toString();e||(e=i.appBasePath+"RemoteUls.ashx"),i.logger.configure({remoteUlsEndpoint:e,sessionId:i.sessionId})}if(i.Ft.initializePeriodicFetch(i.appBasePath,i.sessionId),w&&i.logger.ULS.ft(590966790,s.B,o.Info,JSON.stringify(w)),function(e){try{const t=e.hostInitDiagnostics;e.logger.ULS.ft(558155803,s.B,o.Info,"HostInitDiagnostics: "+(t?JSON.stringify(t):"N/A")),e.logger.ULS.ft(596444237,s.B,o.Important,JSON.stringify({session:ue(e),client:e.clientDiagnostics}))}catch(t){e.logger.ULS.ft(558155804,s.B,o.Error,"Failed to log init info: "+oe(t))}}(i),n.onContextReady&&n.onContextReady(i),i.appInitDiagnostics={officeSessionId:i.sessionId,officeBootstrapperVersion:L(),hostName:i.hostName,documentLoadedWithTabSwitch:"hidden"===document.visibilityState},document.addEventListener("visibilitychange",()=>{i.appInitDiagnostics.documentLoadedWithTabSwitch=!0},{once:!0}),!i.container){const e=t.container;i.container=e instanceof Ue?e:i.application.createContainer(e)}i.container.setMessageHandler(i.onMessage);const g=!!n.ignoreCompletionMessage&&n.ignoreCompletionMessage(i),_=(e,t)=>{var r,a;i.successTime=G(),g||(i.container.postMessage(ee.dn,void 0),r=i.appInitDiagnostics,(a=t.Diagnostics)&&Object.keys(a).forEach(e=>{r[e]=a[e]})),i.Ft.addSettingsChangeListener(i.logger.settingsChangeHandler),n.onSuccess&&n.onSuccess(i,t),i.logger.ULS.ft(596448985,s.B,o.Important,JSON.stringify(i.diagnostics)),$(i.remoteTelemetryUrl,i.application.name,"bootSuccess"),i.logger.ULS.flush(),i.container.postMessage(ee.vn,{HostInitializeDiagnostics:i.hostInitDiagnostics,ClientDiagnostics:i.clientDiagnostics}),i.state=k.Booted,y({completion:"success"}),de(i.appInfo.name,i.logger)},b=(e,t)=>{var r;i.failureTime=G(),n.onFailure&&n.onFailure(i,t.Error),i.logger.ULS.ft(596448986,s.B,o.Error,JSON.stringify({error:t.Error,diagnostics:i.diagnostics})),$(i.remoteTelemetryUrl,i.application.name,"bootFailure"),i.logger.ULS.flush(),i.state=k.Failed,y({completion:"failure",error:t.Error,errorSource:"app",documentLoadedWithTabSwitch:null===(r=i.appInitDiagnostics)||void 0===r?void 0:r.documentLoadedWithTabSwitch}),de(i.appInfo.name,i.logger)},y=t=>{g||(i.bootHeartBeat&&i.bootHeartBeat.stop(),i.removeActionHandler(Y.ls,_),i.removeActionHandler(Y.ns,b)),e(t)};r&&r.subscribe(()=>{var e;y({completion:r.reason||"cancelled",documentLoadedWithTabSwitch:null===(e=i.appInitDiagnostics)||void 0===e?void 0:e.documentLoadedWithTabSwitch})}),g||(i.addActionHandler(Y.ls,_),i.addActionHandler(Y.ns,b)),function(e){(function(e){return"wdjs"in e||"wd1js"in e})(e)&&("true"!==window.sessionStorage.getItem("sideLoadingIsEnabled")?ye("sideLoadingIsEnabled","false",0):function(e,t){const i=Ce("sideLoadingIsEnabled");return"true"===i||"false"!==i&&!1}()||ye("sideLoadingIsEnabled","true",1))}(i.wdParams);const T=n.buildBootRequestParams(i),A=function(e,t,i){let s={...E(e.appUrl),...ii(e),...i};const o=e.rebootOverride;return o&&o.queryOverrides&&(s={...s,...o.queryOverrides}),function(e,t,i){const s=[];for(const e in i)i[e]&&s.push(e+"="+i[e]);return e+t+(s.length>0?"?"+s.join("&"):"")}(e.appBasePath,t,s)}(i,T.appPageName,T.queryParamsOverrides),U=function(e,t){const i=function(e){const t={};I(t,"highdpi",String(window.devicePixelRatio>1.24)),I(t,"softblockedbrowser",String(d())),I(t,"hostname",e.hostName),I(t,"feature_status",re(e.featureManager,e.wdParams)),I(t,"jsapibuild",L());const i=e.wopi;i&&(I(t,"access_token",i.accessToken),I(t,"access_token_ttl",i.expiry.toString()),i.wacToken&&I(t,"wac_token",i.wacToken));const n=e.customFontCatalogUrl;n&&I(t,"customfontcatalogurl",n);const r=e.contentBundle;if(r){if(r.url){I(t,"bundlesrc",r.url);const i=r.staleness,n=null!=i;n&&I(t,Te.Jr,i.toString()),e.logger.ULS.ft(577783775,s.B,o.Info,"Content bundle staleness: "+(n?i:"N/A"))}r.bundleUrlNoAuth&&I(t,"bundleurlnoauth",r.bundleUrlNoAuth),r.bundleCode&&I(t,"bundlecode",r.bundleCode)}const a=e.file,c=a.name;if(c){I(t,"filename",c);const e=se(c);e&&I(t,"fileextension",e)}a.getUrl&&I(t,"filegeturl",a.getUrl),a.downloadCode&&I(t,"filedownloadcode",a.downloadCode),a.urlNoAuth&&I(t,"fileurlnoauth",a.urlNoAuth),a.size&&I(t,"filesize",a.size.toString()),a.eTag&&I(t,"etag",a.eTag),a.cTag&&I(t,"revid",a.cTag),a.uniqueId&&I(t,"docid",a.uniqueId),void 0!==a.immutableReason&&I(t,"immutableReason",a.immutableReason.toString()),void 0!==a.supportsZipIt&&I(t,"supports_zipit",a.supportsZipIt.toString());const l=e.newFileTemplate;l&&(l.getUrl&&I(t,"templateurl",l.getUrl),l.size&&I(t,"filesize",l.size.toString()),l.eTag&&I(t,"etag",l.eTag),l.uniqueId&&I(t,"docid",l.uniqueId)),e.user.id&&I(t,"user_id",e.user.id),e.ownerId&&I(t,"owner_id",e.ownerId),e.sessionContext&&I(t,"sc",e.sessionContext);const h=e.ui;h.controls&&I(t,"huictrls",JSON.stringify(h.controls)),"Templatization"!==h.contentAssemblyMode&&"DocGen"!==h.contentAssemblyMode&&"ContentAssemblyEdit"!==h.contentAssemblyMode&&"ContentAssemblyView"!==h.contentAssemblyMode||I(t,"caae","1"),h.contentAssemblyMode&&I(t,"caaemode",h.contentAssemblyMode);const u=e.meeting;u&&(u.id&&I(t,"meetingId",u.id),u.title&&I(t,"meetingTitle",u.title),u.type&&I(t,"meetingType",u.type),u.scheduledStartTime&&I(t,"scheduledStartTime",u.scheduledStartTime),u.scheduledEndTime&&I(t,"scheduledEndTime",u.scheduledEndTime),u.isPresenter&&I(t,"isPresenter",u.isPresenter.toString()),u.organizerId&&I(t,"meetingOrganizerId",u.organizerId),u.joinUrl&&I(t,"meetingJoinUrl",encodeURIComponent(u.joinUrl)),u.isMeetingTeamsRoom&&I(t,"isMeetingTeamsRoom",u.isMeetingTeamsRoom.toString()));const p=e.host;p.owlVersion&&I(t,"owlver",p.owlVersion),p.owlRollout&&I(t,"owlro",p.owlRollout);const m=p.capabilities;return m&&(m.supportsInPlaceCreateNew&&I(t,"sipcn",m.supportsInPlaceCreateNew.toString()),m.disableEmbedViewCodeSnippet&&I(t,"devcs","1"),m.disableCoEditInTeams&&I(t,"dceit","1")),t}(e);return Object.keys(t).forEach(e=>{t[e]?i[e]=t[e]:delete i[e]}),i}(i,T.postDataOverrides);if(i.bootstrapperUrl&&i.preconnector&&i.preconnector.shouldPreconnect(i.hostName)&&i.preconnector.preconnect(i.bootstrapperUrl),i.bootstrapperUrl&&i.preloader&&i.preloader.shouldPreload(A,i.host.origin,i))try{n.beforePreload&&n.beforePreload(i);let e=i.bootstrapperUrl;i.featureManager.isFeatureEnabled(X.Ti)&&(i.logger.ULS.ft(590966791,s.B,o.Info,"HTTP2 preload enabled"),e=P(e)),i.preloader.preload(e,i.ui.language,i.logger,i.featureManager)}catch(e){i.logger.ULS.ft(590966792,s.B,o.Error,"Error preloading")}n.beforeContainerBoot&&n.beforeContainerBoot(i,A),i.container.boot(A,U,i.logger,n.buildContainerBootParams(i),()=>{i.appInitDiagnostics.officeFrameCreateTime=G(),i.appBootState="FrameCreated"},()=>{i.appInitDiagnostics.officeFrameLoadTime=G(),i.logger.ULS.ft(506012820,s.B,o.Important,"Frame loaded"),"FrameCreated"===i.appBootState&&(i.appBootState="FrameLoaded",i.bootHeartBeat&&i.bootHeartBeat.setTimeoutStage(i.appBootState))},()=>{i.appInitDiagnostics.officeFrameErrorTime=G(),i.logger.ULS.ft(506012819,s.B,o.Error,"Frame error"),i.bootHeartBeat&&i.bootHeartBeat.setFrameError()}),g?_(Y.ls,{Diagnostics:{bootSuccessWithoutCompletionMessage:!0}}):(i.bootHeartBeat=new Et(f(i.appBaseUrl),i.Ft,i.logger,()=>{i.timeoutTime=G(),n.onTimeout&&n.onTimeout(i),$(i.remoteTelemetryUrl,i.application.name,"bootTimeout"),y({completion:"timeout",error:{documentLoadedWithTabSwitch:i.appInitDiagnostics.documentLoadedWithTabSwitch},timeoutStage:i.appBootState}),r&&r.cancel()},r&&n.overrideBootTimeout?Math.min(r.timeoutInMs,n.overrideBootTimeout(i)):r?r.timeoutInMs:n.overrideBootTimeout?n.overrideBootTimeout(i):void 0),n.beforeBootCompletionMessage&&n.beforeBootCompletionMessage(i))}).catch(e=>{throw i.failureTime=G(),n.onException&&n.onException(i,e),i.remoteTelemetryUrl&&$(i.remoteTelemetryUrl,i.application.name,"bootException"),i.bootHeartBeat&&i.bootHeartBeat.stop(),{error:e.toString(),errorStack:e.stack}}),oi=(e,t,i,n,r)=>e!==Y.us?Promise.reject("Wrong flow"):new Promise(e=>{try{window.top&&window.top.close()}catch{i.logger.ULS.ft(579213189,s.B,o.Warning,"Failed to close the browser tab")}e({completion:"success"})}),ni=(e,t,i)=>new Promise(t=>{i.logger.ULS.ft(590111070,s.B,o.Error,"Unsupported flow: "+e),t({completion:"failure"})});class ri{get isCancelled(){return this.Vl}get timeoutInMs(){return this.Bl}get reason(){return this.$l}cancel(){this.Jl(!1)}subscribe(e){this.Vl?e():this.Gl.push(e)}constructor(e){this.Vl=!1,this.$l="",this.Gl=[],this.Jl=e=>{this.Vl||(this.Vl=!0,this.$l=e?"timeout":"cancelled",this.Gl.map(e=>e()),this.Gl=[])},this.Bl=e,window.setTimeout(()=>this.Jl(!0),e)}}function ai(e){return new ri(e)}const ci=(e,t,i,n,r)=>e!==Q.dispose?Promise.reject("Wrong flow"):new Promise(e=>{i.logger.ULS.ft(595714433,s.B,o.Important,"start disposing the application");const a=i.host.requireExplicitUnload,c={disposeStartTime:G(),forceAppUnload:a};i.state=k.Disposing;const l=()=>{i.state=k.Disposed,e({completion:"success"})},h=e=>{n&&n.disposeAppSpecificResources&&n.disposeAppSpecificResources(i,t),i.dispose(),c.disposeEndTime=G(),function(e,t,i){if(i){const e=Number(i.hostMessageReceived);t.appUnloadStartTime&&!isNaN(e)&&(t.hostToAppPostMessageLatency=e-t.appUnloadStartTime);const s=Number(i.appMessageSent);!isNaN(s)&&t.appUnloadEndTime&&(t.appToHostPostMessageLatency=t.appUnloadEndTime-s);const o=Number(i.appUnloadStart),n=Number(i.appUnloadEnd);if(isNaN(o)||isNaN(n)||(t.appUnloadLatency=n-o),i.serverTimings){const e=i.serverTimings;for(const i in e)t["st-"+i.toString()]=e[i]}}e.logger.ULS.ft(592524822,s.B,o.Info,"App disposed: "+JSON.stringify(t)),e.logger.ULS.flushOnClose()}(i,c,e),i.container?i.container.dispose(i.pendingReboot,a).then(l):l()};if(a){c.appUnloadStartTime=G();const e=(e,t)=>{c.appUnloadEndTime=G(),h(t)};i.addActionHandler(Y.so,e),(r||new ri(5e3)).subscribe(()=>{i.state===k.Disposing&&(c.appUnloadTimedOut=!0,h())}),i.container&&i.container.postMessage(ee.Jn,void 0)}else h()}),li=(e,t,i,n,r)=>e!==Y.As?Promise.reject("Wrong flow"):new Promise(e=>{if(i.host.capabilities&&i.host.capabilities.frameTrustCheck)i.raiseEvent(te.FrameTrust,t);else{const e=!!i.container&&i.container.isTopFrameTrusted;i.logger.ULS.ft(592445957,s.B,o.Info,"Top frame is trusted: "+e),i.container&&i.container.postMessage(ee.As,{isTopFrameTrusted:e})}e({completion:"success"})}),hi=(e,t,i,s,o)=>e!==Y.Fs?Promise.reject("Wrong flow"):new Promise(e=>{i.authTokenTrustValidator.isResourceTrustedForMessage(t).then(s=>{s?i.raiseEvent(te.GetAuthToken,t):(i.container.postMessage(ee.Rn,{AuthToken:"",Error:"accessDenied",RequestId:t.RequestId,IdentityType:t.IdentityType}),e({completion:"success"}))},s=>{i.container.postMessage(ee.Rn,{AuthToken:"",Error:"Exception encountered in AuthTokenTrustValidator.isResourceTrustedForMessage",RequestId:t.RequestId,IdentityType:t.IdentityType}),e({completion:"failure",error:s})})}),di=(e,t,i,n,r)=>e!==Y.as?Promise.reject("Wrong flow"):new Promise(e=>{const r=t&&t.state?t.state:"Unknown";i.logger.ULS.ft(592839750,s.B,o.Info,`Boot state: [${r}]`),r!==i.appBootState&&(i.appBootState=r,i.bootHeartBeat&&i.bootHeartBeat.setTimeoutStage(r)),n&&n.beforeComplete&&n.beforeComplete(r),e({completion:"success"})}),ui=(e,t,i,n,r)=>{if(e!==Q.postWacToken)return Promise.reject("Wrong flow");const a=J();return i.logger.ULS.ft(507774685,s.B,o.Important,"postWacToken flow initiated"),new Promise(e=>{const n=(e,t)=>{i.logger.ULS.ft(507597017,s.B,o.Info,`postWacToken flow completed in ${J()-a} ms`),window.clearInterval(l),window.clearTimeout(h);const n={completion:"success"};t&&void 0!==t.TokenAlreadySet&&(n.data={TokenAlreadySet:t.TokenAlreadySet}),r(n)},r=t=>{i.removeActionHandler(Y.Zo,n),e(t)},c=()=>{var e;return null===(e=i.container)||void 0===e?void 0:e.postMessage(ee.er,t)};i.addActionHandler(Y.Zo,n),c();const l=window.setInterval(c,100),h=window.setTimeout(()=>{window.clearInterval(l),i.logger.ULS.ft(507844190,s.B,o.Warning,"postWacToken flow timed out after 60000 milliseconds"),r({completion:"timeout"})},6e4)})},pi=(e,t,i,s,o)=>e!==Q.rename?Promise.reject("Wrong flow"):new Promise(e=>{const s=(e,i)=>{const s={completion:i.NewName===t.NewName?"success":"failure"};r(s)},n=(e,t)=>{r({completion:"failure"})},r=t=>{i.removeActionHandler(Y.Cs,s),i.removeActionHandler(Y.ys,n),e(t)};i.addActionHandler(Y.Cs,s),i.addActionHandler(Y.ys,n),(o||new ri(5e3)).subscribe(()=>{r({completion:"cancelled"})}),i.container&&i.container.postMessage(ee.Pn,t)}),mi=(e,t,i,s,o)=>e!==Q.switchMode?Promise.reject("Wrong flow"):new Promise(e=>{const s=(e,t)=>{n({completion:"success"})},n=t=>{i.removeActionHandler(Y.Ms,s),e(t)};i.addActionHandler(Y.Ms,s),(o||new ri(5e3)).subscribe(()=>{n({completion:"cancelled"})}),i.container&&i.container.postMessage(ee.$n,t)});function fi(e){}function wi(e){Nt(e.logger)}function gi(e){return e.appBaseUrl+"/x/"}function vi(e){return e.appBasePath+"_layouts/"+"RemoteTelemetry.ashx"+((t=e.sessionId)?"?usid="+t:"");var t}function Si(e){const t=e.appUrl,i=Xe(t),n=Ze(t),r=Qe(t);return i||n||r||e.logger.ULS.ft(553673218,s.B,o.Warning,"Unknown endpoint: "+A(t)),!(i||n)}function _i(e){var t;const i=e.appUrl,s=Xe(i),o=Ze(i),n=Qe(i),r=s?"_layouts/xlviewerinternal.aspx":o?"_layouts/xlembed.aspx":n?"_layouts/xlpreview.aspx":function(e){const t=e.toLowerCase().indexOf("/x/");if(t<0)return"";const i=e.indexOf("?");return i<0?e.substring(t+"/x/".length):i<t?"":e.substring(t+"/x/".length,i)}(i),a={},c={};I(a,"wdredirectionreason","Force_SingleStepBoot");const l=e.host.capabilities;l&&l.excelExternalLinks&&I(a,"xlel","1");const h=e.viewMode;h&&(h.hideToolbar&&I(a,"hvt","1"),h.hideEditUpsellDialog&&I(a,"hdeditdlg","1"));const d=e.bootParams;d&&d.isNewFile?(b(a,"unified"),I(a,"edit","1"),I(a,"new","1")):I(a,"instantedit","1");const u=e.ui;u&&(u.hideRibbon&&I(a,"hrbn","1"),u.hideInAppBizChat&&I(a,"hiabc","1")),I(c,Te.ia,JSON.stringify({HostInitializeDiagnostics:e.hostInitDiagnostics,ClientDiagnostics:e.clientDiagnostics}));const p={[Te.sa]:e.hostName,[Te.la]:e.user.id,[Te.Gr]:(null===(t=e.file)||void 0===t?void 0:t.uniqueId)||"noDocId"};gt(e.logger,p,""),I(c,Te.ha,p[Te.ha]),p[Te.ua]&&I(c,Te.ua,p[Te.ua]),I(c,Te.pa,(new Intl.DateTimeFormat).resolvedOptions().timeZone);const m=e.rebootOverride;if(m){let e=m.mode;e&&(e=e.toLowerCase(),"view"===e?I(a,"wdforcedmode","View"):"edit"===e&&I(a,"wdforcedmode","Edit"))}const f=e.file.size;return f&&f>=52428800&&f<=104857600&&I(a,"ilf","1"),{appPageName:r,queryParamsOverrides:a,postDataOverrides:c}}function Ii(e,t){pt(t)&&ht(e.logger,e.container.formId,e.featureManager,e.sessionId),wt(e.logger,void 0,e),Vt(e.logger,void 0,e),Gt(e.logger,void 0,e)}function bi(e){var t,i;return{permissionsPolicy:(i=e.appBaseUrl,`microphone ${i}; autoplay ${i}; camera ${i}; clipboard-read ${i}; clipboard-write ${i}; keyboard-map ${i}; display-capture ${i}`),useFrameFixForTeams:"teams"===(null===(t=e.host.uiHostName)||void 0===t?void 0:t.toLowerCase())}}const Ci=()=>[{[Z.appReboot]:ti,[Z.boot]:si,[Z.closeTab]:oi,[Z.createNew]:ni,[Z.dispose]:ci,[Z.frameTrust]:li,[Z.getAuthToken]:hi,[Z.getHostKeyValue]:Ut,[Z.handleBootState]:di,[Z.postWacToken]:ui,[Z.rename]:pi,[Z.setWacFlightValue]:At,[Z.setOverlayContent]:Ft,[Z.storeHostKeyValue]:Wt,[Z.switchMode]:mi,[Z.updateBootComplete]:ni},{[Z.boot]:{initializeAppContext:fi,beforePreload:wi,buildAppBasePath:gi,buildRemoteTelemetryUrl:vi,ignoreCompletionMessage:Si,buildBootRequestParams:_i,beforeContainerBoot:Ii,buildContainerBootParams:bi,onSuccess:ut},[Z.handleBootState]:{beforeComplete:dt}}];var yi;!function(e){e[e.NotSupported=0]="NotSupported",e[e.SameDocOnly=1]="SameDocOnly",e[e.AnyDoc=2]="AnyDoc",e[e.OtherMode=4]="OtherMode"}(yi||(yi={}));const Ei=new class{GetVersion(){return L()}GetMinContentVersion(){throw new Error("Not implemented")}Prefetch(e){if(null!=e&&void 0!==e){const t=document.createElement("link");t.rel="prefetch";let i=e.BootstrapperUrl;".js"!==i.toString().slice(-3)&&(i+=".js"),t.href=i;const s=document.getElementsByTagName("head")[0];null!=s&&void 0!==s&&s.appendChild(t)}}InitializeWopiPending(e,t,i,n,r,a){let c,l,h,d,u=!1;try{i?l=i:[l,h]=he(),$(Be(e.ApplicationUrl,l),"Excel","init");const p=G();let m;!function(e){if(void 0===e)throw new TypeError("initParams");const t=e.Container;if(void 0===t||void 0===t.appendChild)throw new TypeError("Container");const i=e.SessionInformation;if(void 0===i||void 0===i.HostName||void 0===i.HostSessionId||void 0===i.UserId)throw new TypeError("SessionInformation");const s=e.ApplicationUrl;if(void 0===s||"string"!=typeof s)throw new TypeError("ApplicationUrl");const o=e.WopiPrecheckInfo;if(void 0===o||void 0===o.FileName)throw new TypeError("WopiPrecheckInfo");if(void 0===e.FnOnInitializeSuccess)throw new TypeError("FnOnInitializeSuccess");if(void 0===e.FnOnInitializeFailure)throw new TypeError("FnOnInitializeFailure")}(e),e.ApplicationUrl=v(e.ApplicationUrl,C(e.ApplicationUrl,"region")),e.ApplicationUrl=T(e.ApplicationUrl,"region"),function(e){const t=e.RebootOverrideData;if(t){t.queryOverrides||(t.queryOverrides={});let e=t.mode;if(e)e=e.toLowerCase(),"view"===e?t.queryOverrides.wdforcedmode="View":"edit"===e&&(t.queryOverrides.wdforcedmode="Edit");else{let e=t.reason;e&&(e=e.toLowerCase(),"saveas"===e&&(t.queryOverrides.wdforcedmode="Edit"))}}}(e),c=t||ie({remoteUlsEndpoint:Je(e.ApplicationUrl)+"RemoteUls.ashx",sessionId:l}),d=$e(e,l,c,r,a,this.jl.forceSingleStepBoot),a||(d.Ft.addSettingsChangeListener(c.settingsChangeHandler),d.Ft.initializePeriodicFetch(d.applicationBasePath,l)),d.diagnostics.HostInitDiagnostics&&(d.diagnostics.HostInitDiagnostics.hostInitializeCallTime=p),ze(c,d,h),u=!0;const f=e.BootstrapperUrl;f&&(m=this.ql(f,c));const w=()=>{d.Ft.dispose(),d.pageStateObserver.dispose(),window.clearInterval(m)},g=S(e.ApplicationUrl),_=n||new yt(g,c),I=new Ht,b=function(e,t){let i={isSingleStepBoot:e.forceSingleStepBoot,bootFlowType:e.forceSingleStepBoot?_t.forceSingleStepBoot:_t.bootWithoutWopiInfo,ignoreWacFramePostMessages:!1};if(e.forceSingleStepBoot||(i=function(e,t){const i=e.applicationUrl,n=Xe(i),r=Ze(i),a=Qe(i),c={isSingleStepBoot:!0,bootFlowType:_t.forceSingleStepBoot,ignoreWacFramePostMessages:!(n||r)};return n||r||a||t.ULS.ft(553673219,s.B,o.Warning,"Unknown endpoint: "+A(i)),c}(e,t)),i.isSingleStepBoot){const n={singleStepBootIsRequired:!0,singleStepBootReason:i.bootFlowType,irmEnabled:e.wopiPrecheckInfo.IrmEnabled,readOnly:e.wopiPrecheckInfo.ReadOnly,ignoreWacFramePostMessages:i.ignoreWacFramePostMessages};t.ULS.ft(596444182,s.B,n.irmEnabled?o.Warning:o.Info,JSON.stringify(n))}else t.ULS.ft(596444183,s.B,o.Info,"Received input valid for two step flow");return i}(d,c),y=function(e,t,i,n,r,a,c){return l=>{const h=e.diagnostics;qe(h,n),je(h.SessionTraces,i,o.Info);const d=zt(h);i.ULS.ft(596448985,s.B,o.Important,JSON.stringify(d)),$(e.remoteTelemetryUrl,"Excel","bootSuccess");const u=c(e.sessionId,i,t,r,l);try{a(u,d)}catch(e){i.ULS.ft(595719171,s.B,o.Error,"Exception thrown from host's success callback: "+oe(e))}de("excel",i),qt(i)}}(d,_,c,I,w,e.FnOnInitializeSuccess,this.zl),E=function(e,t,i,n){return r=>{const a=e.diagnostics;qe(a,i),je(a.SessionTraces,t,o.Warning);const c=zt(a);void 0!==r&&"Js Boot Failed"!==r.errorObject.errorType&&t.ULS.ft(575931487,s.B,o.Error,"Core JS failure recieved "+JSON.stringify(r)),t.ULS.ft(596448986,s.B,o.Error,JSON.stringify({error:r,appInitDiagnostics:c})),$(e.remoteTelemetryUrl,"Excel","bootFailure");try{n(r,c)}catch(e){t.ULS.ft(595719172,s.B,o.Error,"Exception thrown from host's failure callback: "+oe(e))}de("excel",t),qt(t)}}(d,c,I,e.FnOnInitializeFailure);e.FnOnAppModeSwitched&&_.registerMessagePayloadHandler(Y.Ms,e.FnOnAppModeSwitched),wt(c,_),Vt(c,_),Gt(c,_),Nt(c),e.WopiPrecheckInfo.ReadOnly&&e.FnOnAppModeSwitched;const F=C(d.applicationUrl,"uih");if(f&&this.jl.preconnector&&this.jl.preconnector.shouldPreconnect(F)&&this.jl.preconnector.preconnect(f),f&&this.jl.preloader&&this.jl.preloader.shouldPreload(d.applicationUrl))try{let e=f;d.featureManager.isFeatureEnabled(X.Ti)&&(c.ULS.ft(595645891,s.B,o.Info,"HTTP2 preload enabled"),e=P(f));let t=d.sessionInformation.UiLocale;t||(t=decodeURIComponent(C(d.applicationUrl,"ui"))),this.jl.preloader.preload(e,t,c,d.featureManager)}catch(e){c.ULS.ft(595943884,s.B,o.Error,"Error preloading")}const R=new Mt(d,b,c,_,w,y,E);return R.Boot(),R}catch(t){return c&&(c.ULS.ft(596459925,s.B,o.Error,`${Ne.AppInitError}: ${oe(t)}`),u||ze(c,d||$e(e,l,c,r,a,this.jl.forceSingleStepBoot),h),c.ULS.flushOnClose()),void(e&&(e.ApplicationUrl&&$(Be(e.ApplicationUrl,l),"Excel","bootException"),e.FnOnInitializeFailure&&e.FnOnInitializeFailure({errorType:Ne.AppInitError,errorObject:t})))}}constructor(e,t){this.ql=(e,t)=>window.setInterval(()=>{this.Prefetch({BootstrapperUrl:e}),t.ULS.ft(595895774,s.B,o.Info,"Prefetching "+A(e))},36e5),this.zl=e,this.jl=t}}((function(e,t,i,s,o){return new Xt(e,t,i,s,o)}),{forceSingleStepBoot:!1,preloader:O(Zt,ei),preconnector:M(!0)}),Ti=e=>{const t={name:"Excel",preloader:O(Zt,ei),preconnector:M(!0)};return new Oe(e,t,Ci)}}});
//# sourceMappingURL=excel-boot.b8066dd9515af1aac1af.js.map